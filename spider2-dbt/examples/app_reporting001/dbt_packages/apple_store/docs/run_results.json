{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2024-07-23T15:57:04.983701Z", "invocation_id": "ec007210-b87e-49d0-9f4f-20ad8d5c727c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.630053Z", "completed_at": "2024-07-23T15:57:02.670145Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.676892Z", "completed_at": "2024-07-23T15:57:02.676901Z"}], "thread_id": "Thread-1", "execution_time": 0.05161929130554199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_device_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"app_store_source_type_device\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.655272Z", "completed_at": "2024-07-23T15:57:02.676362Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.678367Z", "completed_at": "2024-07-23T15:57:02.678371Z"}], "thread_id": "Thread-2", "execution_time": 0.05217909812927246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_platform_version_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"app_store_platform_version_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_platform_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.664741Z", "completed_at": "2024-07-23T15:57:02.677452Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.679127Z", "completed_at": "2024-07-23T15:57:02.679130Z"}], "thread_id": "Thread-5", "execution_time": 0.05095696449279785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__crashes_app_version_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"crashes_app_version\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.667461Z", "completed_at": "2024-07-23T15:57:02.677659Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.679900Z", "completed_at": "2024-07-23T15:57:02.679903Z"}], "thread_id": "Thread-6", "execution_time": 0.05114293098449707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__crashes_platform_version_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"crashes_platform_version\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_platform_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.658705Z", "completed_at": "2024-07-23T15:57:02.677854Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.680444Z", "completed_at": "2024-07-23T15:57:02.680447Z"}], "thread_id": "Thread-3", "execution_time": 0.05338907241821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_territory_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"app_store_territory_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_territory_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.661457Z", "completed_at": "2024-07-23T15:57:02.678076Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.680803Z", "completed_at": "2024-07-23T15:57:02.680807Z"}], "thread_id": "Thread-4", "execution_time": 0.05296516418457031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"app\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.673828Z", "completed_at": "2024-07-23T15:57:02.679668Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.681946Z", "completed_at": "2024-07-23T15:57:02.681949Z"}], "thread_id": "Thread-8", "execution_time": 0.052269935607910156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_platform_version_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"downloads_platform_version_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_platform_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.670425Z", "completed_at": "2024-07-23T15:57:02.680242Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.682603Z", "completed_at": "2024-07-23T15:57:02.682606Z"}], "thread_id": "Thread-7", "execution_time": 0.053498029708862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_device_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"downloads_source_type_device\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.685664Z", "completed_at": "2024-07-23T15:57:02.701449Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.710204Z", "completed_at": "2024-07-23T15:57:02.710210Z"}], "thread_id": "Thread-1", "execution_time": 0.028850793838500977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_territory_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"downloads_territory_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_territory_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.692297Z", "completed_at": "2024-07-23T15:57:02.709712Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.711212Z", "completed_at": "2024-07-23T15:57:02.711215Z"}], "thread_id": "Thread-5", "execution_time": 0.027324914932250977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_subscription_events_tmp", "compiled": true, "compiled_code": "\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"sales_subscription_events\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.689707Z", "completed_at": "2024-07-23T15:57:02.709955Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.711613Z", "completed_at": "2024-07-23T15:57:02.711617Z"}], "thread_id": "Thread-2", "execution_time": 0.028156757354736328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_account_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"sales_account\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.695334Z", "completed_at": "2024-07-23T15:57:02.710746Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.712453Z", "completed_at": "2024-07-23T15:57:02.712460Z"}], "thread_id": "Thread-6", "execution_time": 0.02805805206298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_subscription_summary_tmp", "compiled": true, "compiled_code": "\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"sales_subscription_summary\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.698996Z", "completed_at": "2024-07-23T15:57:02.710956Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.713297Z", "completed_at": "2024-07-23T15:57:02.713300Z"}], "thread_id": "Thread-3", "execution_time": 0.028416872024536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_app_version_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"usage_app_version_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_app_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.704169Z", "completed_at": "2024-07-23T15:57:02.711971Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.714157Z", "completed_at": "2024-07-23T15:57:02.714159Z"}], "thread_id": "Thread-8", "execution_time": 0.02558279037475586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_platform_version_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"usage_platform_version_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_platform_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.706925Z", "completed_at": "2024-07-23T15:57:02.712898Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.715020Z", "completed_at": "2024-07-23T15:57:02.715022Z"}], "thread_id": "Thread-7", "execution_time": 0.025999069213867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_territory_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"usage_territory_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_territory_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.701667Z", "completed_at": "2024-07-23T15:57:02.713103Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.715369Z", "completed_at": "2024-07-23T15:57:02.715372Z"}], "thread_id": "Thread-4", "execution_time": 0.030209064483642578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_device_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"usage_source_type_device\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.718518Z", "completed_at": "2024-07-23T15:57:02.719769Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.724540Z", "completed_at": "2024-07-23T15:57:02.724545Z"}], "thread_id": "Thread-1", "execution_time": 0.010070085525512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.app", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.720830Z", "completed_at": "2024-07-23T15:57:02.722805Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.727917Z", "completed_at": "2024-07-23T15:57:02.727921Z"}], "thread_id": "Thread-5", "execution_time": 0.01203608512878418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.app_store_platform_version_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.723024Z", "completed_at": "2024-07-23T15:57:02.724140Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.728274Z", "completed_at": "2024-07-23T15:57:02.728277Z"}], "thread_id": "Thread-2", "execution_time": 0.012167930603027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.app_store_source_type_device", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.724886Z", "completed_at": "2024-07-23T15:57:02.725995Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.730217Z", "completed_at": "2024-07-23T15:57:02.730221Z"}], "thread_id": "Thread-6", "execution_time": 0.013397932052612305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.app_store_territory_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.726573Z", "completed_at": "2024-07-23T15:57:02.727707Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.733830Z", "completed_at": "2024-07-23T15:57:02.733834Z"}], "thread_id": "Thread-3", "execution_time": 0.016238689422607422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.crashes_app_version", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.728643Z", "completed_at": "2024-07-23T15:57:02.729795Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.734641Z", "completed_at": "2024-07-23T15:57:02.734644Z"}], "thread_id": "Thread-8", "execution_time": 0.01639103889465332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.crashes_platform_version", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.730568Z", "completed_at": "2024-07-23T15:57:02.732317Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.735391Z", "completed_at": "2024-07-23T15:57:02.735394Z"}], "thread_id": "Thread-7", "execution_time": 0.015244245529174805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.downloads_platform_version_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.732531Z", "completed_at": "2024-07-23T15:57:02.733632Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.735721Z", "completed_at": "2024-07-23T15:57:02.735723Z"}], "thread_id": "Thread-4", "execution_time": 0.015346050262451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.downloads_source_type_device", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.738553Z", "completed_at": "2024-07-23T15:57:02.739714Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.743570Z", "completed_at": "2024-07-23T15:57:02.743574Z"}], "thread_id": "Thread-1", "execution_time": 0.00866389274597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.downloads_territory_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.740735Z", "completed_at": "2024-07-23T15:57:02.741869Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.747618Z", "completed_at": "2024-07-23T15:57:02.747622Z"}], "thread_id": "Thread-5", "execution_time": 0.011435985565185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.sales_account", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.742070Z", "completed_at": "2024-07-23T15:57:02.743189Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.747970Z", "completed_at": "2024-07-23T15:57:02.747973Z"}], "thread_id": "Thread-2", "execution_time": 0.011554241180419922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.sales_subscription_events", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.743908Z", "completed_at": "2024-07-23T15:57:02.745049Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.749833Z", "completed_at": "2024-07-23T15:57:02.749837Z"}], "thread_id": "Thread-6", "execution_time": 0.012796163558959961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.sales_subscription_summary", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.745606Z", "completed_at": "2024-07-23T15:57:02.747419Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.752788Z", "completed_at": "2024-07-23T15:57:02.752791Z"}], "thread_id": "Thread-3", "execution_time": 0.01510310173034668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.usage_app_version_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.748303Z", "completed_at": "2024-07-23T15:57:02.749415Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.753594Z", "completed_at": "2024-07-23T15:57:02.753597Z"}], "thread_id": "Thread-8", "execution_time": 0.015311717987060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.usage_platform_version_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.750193Z", "completed_at": "2024-07-23T15:57:02.751306Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.754580Z", "completed_at": "2024-07-23T15:57:02.754584Z"}], "thread_id": "Thread-7", "execution_time": 0.014523029327392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.usage_source_type_device", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.751507Z", "completed_at": "2024-07-23T15:57:02.752589Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.754998Z", "completed_at": "2024-07-23T15:57:02.755002Z"}], "thread_id": "Thread-4", "execution_time": 0.014729022979736328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.usage_territory_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.757980Z", "completed_at": "2024-07-23T15:57:02.759289Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:02.779997Z", "completed_at": "2024-07-23T15:57:02.780002Z"}], "thread_id": "Thread-1", "execution_time": 0.026105880737304688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_source.apple_store_country_codes", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.785538Z", "completed_at": "2024-07-23T15:57:03.557366Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:03.557731Z", "completed_at": "2024-07-23T15:57:03.557746Z"}], "thread_id": "Thread-3", "execution_time": 0.8452920913696289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__crashes_platform_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_platform_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    crashes\n    \n as \n    \n    crashes\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    platform_version\n    \n as \n    \n    platform_version\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(device as TEXT) as device,\n        cast(platform_version as TEXT) as platform_version,\n        cast(crashes as bigint) as crashes\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_platform_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.794715Z", "completed_at": "2024-07-23T15:57:03.601683Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:03.602882Z", "completed_at": "2024-07-23T15:57:03.602886Z"}], "thread_id": "Thread-7", "execution_time": 0.9658689498901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_territory", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_territory_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    impressions_unique_device\n    \n as \n    \n    impressions_unique_device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    page_views\n    \n as \n    \n    page_views\n    \n, \n    \n    \n    page_views_unique_device\n    \n as \n    \n    page_views_unique_device\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    territory\n    \n as \n    \n    territory\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(territory as TEXT) as territory,\n        cast(impressions as bigint) as impressions,\n        cast(impressions_unique_device as bigint) as impressions_unique_device,\n        cast(page_views as bigint) as page_views,\n        cast(page_views_unique_device as bigint) as page_views_unique_device\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_territory\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.766649Z", "completed_at": "2024-07-23T15:57:03.601432Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:03.602141Z", "completed_at": "2024-07-23T15:57:03.602147Z"}], "thread_id": "Thread-2", "execution_time": 0.9792320728302002, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_platform_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_platform_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    impressions_unique_device\n    \n as \n    \n    impressions_unique_device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    page_views\n    \n as \n    \n    page_views\n    \n, \n    \n    \n    page_views_unique_device\n    \n as \n    \n    page_views_unique_device\n    \n, \n    \n    \n    platform_version\n    \n as \n    \n    platform_version\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(platform_version as TEXT) as platform_version,\n        cast(impressions as bigint) as impressions,\n        cast(impressions_unique_device as bigint) as impressions_unique_device,\n        cast(page_views as bigint) as page_views,\n        cast(page_views_unique_device as bigint) as page_views_unique_device\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_platform_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.835633Z", "completed_at": "2024-07-23T15:57:03.676800Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:03.677110Z", "completed_at": "2024-07-23T15:57:03.677119Z"}], "thread_id": "Thread-1", "execution_time": 0.9269471168518066, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_device", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    first_time_downloads\n    \n as \n    \n    first_time_downloads\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    redownloads\n    \n as \n    \n    redownloads\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    total_downloads\n    \n as \n    \n    total_downloads\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(device as TEXT) as device,\n        cast(first_time_downloads as bigint) as first_time_downloads,\n        cast(redownloads as bigint) as redownloads,\n        cast(total_downloads as bigint) as total_downloads\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.780388Z", "completed_at": "2024-07-23T15:57:03.759606Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:03.767760Z", "completed_at": "2024-07-23T15:57:03.767765Z"}], "thread_id": "Thread-6", "execution_time": 1.1007161140441895, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__crashes_app_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    app_version\n    \n as \n    \n    app_version\n    \n, \n    \n    \n    crashes\n    \n as \n    \n    crashes\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(device as TEXT) as device,\n        cast(app_version as TEXT) as app_version,\n        cast(crashes as bigint) as crashes\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.760341Z", "completed_at": "2024-07-23T15:57:03.767224Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:03.768783Z", "completed_at": "2024-07-23T15:57:03.768786Z"}], "thread_id": "Thread-5", "execution_time": 1.1022651195526123, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_device", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    impressions_unique_device\n    \n as \n    \n    impressions_unique_device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    page_views\n    \n as \n    \n    page_views\n    \n, \n    \n    \n    page_views_unique_device\n    \n as \n    \n    page_views_unique_device\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(device as TEXT) as device,\n        cast(impressions as bigint) as impressions,\n        cast(impressions_unique_device as bigint) as impressions_unique_device,\n        cast(page_views as bigint) as page_views,\n        cast(page_views_unique_device as bigint) as page_views_unique_device\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.827817Z", "completed_at": "2024-07-23T15:57:03.759932Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:03.767991Z", "completed_at": "2024-07-23T15:57:03.767995Z"}], "thread_id": "Thread-4", "execution_time": 1.0985190868377686, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_platform_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_platform_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    first_time_downloads\n    \n as \n    \n    first_time_downloads\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    platform_version\n    \n as \n    \n    platform_version\n    \n, \n    \n    \n    redownloads\n    \n as \n    \n    redownloads\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    total_downloads\n    \n as \n    \n    total_downloads\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(platform_version as TEXT) as platform_version,\n        cast(first_time_downloads as bigint) as first_time_downloads,\n        cast(redownloads as bigint) as redownloads,\n        cast(total_downloads as bigint) as total_downloads\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_platform_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:02.790232Z", "completed_at": "2024-07-23T15:57:03.767526Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:03.769221Z", "completed_at": "2024-07-23T15:57:03.769224Z"}], "thread_id": "Thread-8", "execution_time": 1.1020381450653076, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_opt_in_rate\n    \n as \n    \n    app_opt_in_rate\n    \n, \n    \n    \n    asset_token\n    \n as \n    \n    asset_token\n    \n, \n    \n    \n    icon_url\n    \n as \n    \n    icon_url\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ios\n    \n as \n    \n    ios\n    \n, \n    \n    \n    is_bundle\n    \n as \n    \n    is_bundle\n    \n, \n    \n    \n    is_enabled\n    \n as \n    \n    is_enabled\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    pre_order_info\n    \n as \n    \n    pre_order_info\n    \n, \n    \n    \n    tvos\n    \n as \n    \n    tvos\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(id as bigint) as app_id,\n        cast(name as TEXT) as app_name,\n        is_enabled\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:03.604183Z", "completed_at": "2024-07-23T15:57:04.425788Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.426256Z", "completed_at": "2024-07-23T15:57:04.426269Z"}], "thread_id": "Thread-3", "execution_time": 0.8886420726776123, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_territory", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_territory_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    first_time_downloads\n    \n as \n    \n    first_time_downloads\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    redownloads\n    \n as \n    \n    redownloads\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    territory\n    \n as \n    \n    territory\n    \n, \n    \n    \n    total_downloads\n    \n as \n    \n    total_downloads\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(territory as TEXT) as territory,\n        cast(first_time_downloads as bigint) as first_time_downloads,\n        cast(redownloads as bigint) as redownloads,\n        cast(total_downloads as bigint) as total_downloads\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_territory\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.504031Z", "completed_at": "2024-07-23T15:57:04.520956Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.521319Z", "completed_at": "2024-07-23T15:57:04.521327Z"}], "thread_id": "Thread-3", "execution_time": 0.0181729793548584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__crashes_platform_version_source_relation__date_day__app_id__device__platform_version.5bf4ea102a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, device, platform_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_platform_version\"\n    group by source_relation, date_day, app_id, device, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.523049Z", "completed_at": "2024-07-23T15:57:04.529380Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.530049Z", "completed_at": "2024-07-23T15:57:04.530056Z"}], "thread_id": "Thread-3", "execution_time": 0.0077800750732421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__app_store_territory_source_relation__date_day__app_id__source_type__territory.d4a759ea32", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, territory\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_territory\"\n    group by source_relation, date_day, app_id, source_type, territory\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.531588Z", "completed_at": "2024-07-23T15:57:04.535550Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.535821Z", "completed_at": "2024-07-23T15:57:04.535826Z"}], "thread_id": "Thread-3", "execution_time": 0.00492405891418457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__app_store_platform_version_source_relation__date_day__app_id__source_type__platform_version.f38f8df8b1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, platform_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_platform_version\"\n    group by source_relation, date_day, app_id, source_type, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.545789Z", "completed_at": "2024-07-23T15:57:04.549844Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.550093Z", "completed_at": "2024-07-23T15:57:04.550098Z"}], "thread_id": "Thread-3", "execution_time": 0.004857778549194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__downloads_device_source_relation__date_day__app_id__source_type__device.0b46c778ff", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, device\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device\"\n    group by source_relation, date_day, app_id, source_type, device\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.574724Z", "completed_at": "2024-07-23T15:57:04.578454Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.578681Z", "completed_at": "2024-07-23T15:57:04.578685Z"}], "thread_id": "Thread-3", "execution_time": 0.004431247711181641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__crashes_app_version_source_relation__date_day__app_id__device__app_version.2cba4b46da", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, device, app_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version\"\n    group by source_relation, date_day, app_id, device, app_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.586363Z", "completed_at": "2024-07-23T15:57:04.589145Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.589358Z", "completed_at": "2024-07-23T15:57:04.589362Z"}], "thread_id": "Thread-3", "execution_time": 0.0034589767456054688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__app_store_device_source_relation__date_day__app_id__source_type__device.019465f61c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, device\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device\"\n    group by source_relation, date_day, app_id, source_type, device\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.590378Z", "completed_at": "2024-07-23T15:57:04.593137Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.593353Z", "completed_at": "2024-07-23T15:57:04.593357Z"}], "thread_id": "Thread-3", "execution_time": 0.0034558773040771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__downloads_platform_version_source_relation__date_day__app_id__source_type__platform_version.b3f49f6945", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, platform_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_platform_version\"\n    group by source_relation, date_day, app_id, source_type, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:03.769762Z", "completed_at": "2024-07-23T15:57:04.565382Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.565825Z", "completed_at": "2024-07-23T15:57:04.565830Z"}], "thread_id": "Thread-2", "execution_time": 0.8682770729064941, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_account", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(id as bigint) as account_id,\n        cast(name as TEXT) as account_name\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.594364Z", "completed_at": "2024-07-23T15:57:04.629481Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.630055Z", "completed_at": "2024-07-23T15:57:04.630060Z"}], "thread_id": "Thread-3", "execution_time": 0.0362238883972168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__app_source_relation__app_id.8b3ebfee12", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, app_id\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n    group by source_relation, app_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.631627Z", "completed_at": "2024-07-23T15:57:04.639315Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.639567Z", "completed_at": "2024-07-23T15:57:04.639572Z"}], "thread_id": "Thread-2", "execution_time": 0.00985407829284668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__downloads_territory_source_relation__date_day__app_id__source_type__territory.602f5096ce", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, territory\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_territory\"\n    group by source_relation, date_day, app_id, source_type, territory\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.635833Z", "completed_at": "2024-07-23T15:57:04.640040Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.640252Z", "completed_at": "2024-07-23T15:57:04.640255Z"}], "thread_id": "Thread-3", "execution_time": 0.0052471160888671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__sales_account_source_relation__account_id.4e93cfed18", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account\"\n    group by source_relation, account_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:03.863409Z", "completed_at": "2024-07-23T15:57:04.565605Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.566060Z", "completed_at": "2024-07-23T15:57:04.566064Z"}], "thread_id": "Thread-6", "execution_time": 0.846466064453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_app_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_app_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active_devices\n    \n as \n    \n    active_devices\n    \n, \n    \n    \n    active_devices_last_30_days\n    \n as \n    \n    active_devices_last_30_days\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    app_version\n    \n as \n    \n    app_version\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    deletions\n    \n as \n    \n    deletions\n    \n, \n    \n    \n    installations\n    \n as \n    \n    installations\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    sessions\n    \n as \n    \n    sessions\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(app_version as TEXT) as app_version,\n        cast(active_devices as bigint) as active_devices,\n        cast(active_devices_last_30_days as bigint) as active_devices_last_30_days,\n        cast(deletions as bigint) as deletions,\n        cast(installations as bigint) as installations,\n        cast(sessions as bigint) as sessions\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_app_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:03.883062Z", "completed_at": "2024-07-23T15:57:04.630989Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.634647Z", "completed_at": "2024-07-23T15:57:04.634651Z"}], "thread_id": "Thread-8", "execution_time": 0.8507199287414551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_device", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active_devices\n    \n as \n    \n    active_devices\n    \n, \n    \n    \n    active_devices_last_30_days\n    \n as \n    \n    active_devices_last_30_days\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    deletions\n    \n as \n    \n    deletions\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    installations\n    \n as \n    \n    installations\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    sessions\n    \n as \n    \n    sessions\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(device as TEXT) as device,\n        cast(active_devices as bigint) as active_devices,\n        cast(active_devices_last_30_days as bigint) as active_devices_last_30_days,\n        cast(deletions as bigint) as deletions,\n        cast(installations as bigint) as installations,\n        cast(sessions as bigint) as sessions\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:03.870545Z", "completed_at": "2024-07-23T15:57:04.630785Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.634415Z", "completed_at": "2024-07-23T15:57:04.634419Z"}], "thread_id": "Thread-5", "execution_time": 0.8538620471954346, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_platform_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_platform_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active_devices\n    \n as \n    \n    active_devices\n    \n, \n    \n    \n    active_devices_last_30_days\n    \n as \n    \n    active_devices_last_30_days\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    deletions\n    \n as \n    \n    deletions\n    \n, \n    \n    \n    installations\n    \n as \n    \n    installations\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    platform_version\n    \n as \n    \n    platform_version\n    \n, \n    \n    \n    sessions\n    \n as \n    \n    sessions\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(platform_version as TEXT) as platform_version,\n        cast(active_devices as bigint) as active_devices,\n        cast(active_devices_last_30_days as bigint) as active_devices_last_30_days,\n        cast(deletions as bigint) as deletions,\n        cast(installations as bigint) as installations,\n        cast(sessions as bigint) as sessions\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_platform_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:03.775343Z", "completed_at": "2024-07-23T15:57:04.631185Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.634855Z", "completed_at": "2024-07-23T15:57:04.634858Z"}], "thread_id": "Thread-1", "execution_time": 0.945950984954834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_subscription_summary", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _filename\n    \n as \n    \n    _filename\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _index\n    \n as \n    \n    _index\n    \n, \n    \n    \n    account_number\n    \n as \n    \n    account_number\n    \n, \n    \n    \n    active_free_trial_introductory_offer_subscriptions\n    \n as \n    \n    active_free_trial_introductory_offer_subscriptions\n    \n, \n    \n    \n    active_pay_as_you_go_introductory_offer_subscriptions\n    \n as \n    \n    active_pay_as_you_go_introductory_offer_subscriptions\n    \n, \n    \n    \n    active_pay_up_front_introductory_offer_subscriptions\n    \n as \n    \n    active_pay_up_front_introductory_offer_subscriptions\n    \n, \n    \n    \n    active_standard_price_subscriptions\n    \n as \n    \n    active_standard_price_subscriptions\n    \n, \n    \n    \n    app_apple_id\n    \n as \n    \n    app_apple_id\n    \n, \n    \n    \n    app_name\n    \n as \n    \n    app_name\n    \n, \n    \n    \n    billing_retry\n    \n as \n    \n    billing_retry\n    \n, \n    \n    \n    country\n    \n as \n    \n    country\n    \n, \n    \n    \n    customer_currency\n    \n as \n    \n    customer_currency\n    \n, \n    \n    \n    customer_price\n    \n as \n    \n    customer_price\n    \n, \n    \n    \n    developer_proceeds\n    \n as \n    \n    developer_proceeds\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    free_trial_promotional_offer_subscriptions\n    \n as \n    \n    free_trial_promotional_offer_subscriptions\n    \n, \n    \n    \n    grace_period\n    \n as \n    \n    grace_period\n    \n, \n    \n    \n    marketing_opt_ins\n    \n as \n    \n    marketing_opt_ins\n    \n, \n    \n    \n    pay_as_you_go_promotional_offer_subscriptions\n    \n as \n    \n    pay_as_you_go_promotional_offer_subscriptions\n    \n, \n    \n    \n    pay_up_front_promotional_offer_subscriptions\n    \n as \n    \n    pay_up_front_promotional_offer_subscriptions\n    \n, \n    \n    \n    proceeds_currency\n    \n as \n    \n    proceeds_currency\n    \n, \n    \n    \n    proceeds_reason\n    \n as \n    \n    proceeds_reason\n    \n, \n    \n    \n    promotional_offer_id\n    \n as \n    \n    promotional_offer_id\n    \n, \n    \n    \n    promotional_offer_name\n    \n as \n    \n    promotional_offer_name\n    \n, \n    \n    \n    standard_subscription_duration\n    \n as \n    \n    standard_subscription_duration\n    \n, \n    \n    \n    state\n    \n as \n    \n    state\n    \n, \n    \n    \n    subscription_apple_id\n    \n as \n    \n    subscription_apple_id\n    \n, \n    \n    \n    subscription_group_id\n    \n as \n    \n    subscription_group_id\n    \n, \n    \n    \n    subscription_name\n    \n as \n    \n    subscription_name\n    \n, \n    \n    \n    vendor_number\n    \n as \n    \n    vendor_number\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(\n\n    to_date(\n      \n\n  \n    \n\n    split_part(\n        _filename,\n        '_',\n        3\n        )\n\n\n  \n\n, \n      'YYYYMMDD'\n    )\n\n as date) as date_day, \n        cast(app_name as TEXT) as app_name,\n        cast(account_number as bigint) as account_id,\n        cast(country as TEXT) as country,\n        cast(case\n            when replace(state, ' ', '') = '' then cast(null as TEXT) else state\n        end as TEXT) as state,\n        cast(subscription_name as TEXT) as subscription_name,\n        cast(case \n            when lower(device) like 'ipod%' then 'iPod' else device\n        end as TEXT) as device,\n        sum(cast(active_free_trial_introductory_offer_subscriptions as bigint)) as active_free_trial_introductory_offer_subscriptions,\n        sum(cast(active_pay_as_you_go_introductory_offer_subscriptions as bigint)) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(cast(active_pay_up_front_introductory_offer_subscriptions as bigint)) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(cast(active_standard_price_subscriptions as bigint)) as active_standard_price_subscriptions\n    from fields\n    group by 1,2,3,4,5,6,7,8\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.726342Z", "completed_at": "2024-07-23T15:57:04.783362Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.784798Z", "completed_at": "2024-07-23T15:57:04.784803Z"}], "thread_id": "Thread-6", "execution_time": 0.0663459300994873, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__usage_app_version_source_relation__date_day__app_id__source_type__app_version.29b2c0e4d2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, app_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_app_version\"\n    group by source_relation, date_day, app_id, source_type, app_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.762973Z", "completed_at": "2024-07-23T15:57:04.785590Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.787156Z", "completed_at": "2024-07-23T15:57:04.787160Z"}], "thread_id": "Thread-5", "execution_time": 0.06844878196716309, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__usage_device_source_relation__date_day__app_id__source_type__device.aa048fdf6c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, device\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device\"\n    group by source_relation, date_day, app_id, source_type, device\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:03.760950Z", "completed_at": "2024-07-23T15:57:04.717145Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.719210Z", "completed_at": "2024-07-23T15:57:04.719214Z"}], "thread_id": "Thread-7", "execution_time": 1.050900936126709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_subscription_events", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _filename\n    \n as \n    \n    _filename\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _index\n    \n as \n    \n    _index\n    \n, \n    \n    \n    account_number\n    \n as \n    \n    account_number\n    \n, \n    \n    \n    app_apple_id\n    \n as \n    \n    app_apple_id\n    \n, \n    \n    \n    app_name\n    \n as \n    \n    app_name\n    \n, \n    \n    \n    cancellation_reason\n    \n as \n    \n    cancellation_reason\n    \n, \n    \n    \n    consecutive_paid_periods\n    \n as \n    \n    consecutive_paid_periods\n    \n, \n    \n    \n    country\n    \n as \n    \n    country\n    \n, \n    \n    \n    days_before_canceling\n    \n as \n    \n    days_before_canceling\n    \n, \n    \n    \n    days_canceled\n    \n as \n    \n    days_canceled\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    event\n    \n as \n    \n    event\n    \n, \n    \n    \n    event_date\n    \n as \n    \n    event_date\n    \n, \n    \n    \n    marketing_opt_in_duration\n    \n as \n    \n    marketing_opt_in_duration\n    \n, \n    \n    \n    original_start_date\n    \n as \n    \n    original_start_date\n    \n, \n    \n    \n    previous_subscription_apple_id\n    \n as \n    \n    previous_subscription_apple_id\n    \n, \n    \n    \n    previous_subscription_name\n    \n as \n    \n    previous_subscription_name\n    \n, \n    \n    \n    proceeds_reason\n    \n as \n    \n    proceeds_reason\n    \n, \n    \n    \n    promotional_offer_id\n    \n as \n    \n    promotional_offer_id\n    \n, \n    \n    \n    promotional_offer_name\n    \n as \n    \n    promotional_offer_name\n    \n, \n    \n    \n    quantity\n    \n as \n    \n    quantity\n    \n, \n    \n    \n    standard_subscription_duration\n    \n as \n    \n    standard_subscription_duration\n    \n, \n    \n    \n    state\n    \n as \n    \n    state\n    \n, \n    \n    \n    subscription_apple_id\n    \n as \n    \n    subscription_apple_id\n    \n, \n    \n    \n    subscription_group_id\n    \n as \n    \n    subscription_group_id\n    \n, \n    \n    \n    subscription_name\n    \n as \n    \n    subscription_name\n    \n, \n    \n    \n    subscription_offer_duration\n    \n as \n    \n    subscription_offer_duration\n    \n, \n    \n    \n    subscription_offer_type\n    \n as \n    \n    subscription_offer_type\n    \n, \n    \n    \n    vendor_number\n    \n as \n    \n    vendor_number\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(event_date as date) as date_day,\n        cast(account_number as bigint) as account_id,\n        cast(app_name as TEXT) as app_name,\n        cast(subscription_name as TEXT) as subscription_name,\n        cast(event as TEXT) as event,\n        cast(country as TEXT) as country,\n        cast(case\n            when replace(state, ' ', '') = '' then cast(null as TEXT) else state\n        end as TEXT) as state,\n        cast(case \n            when lower(device) like 'ipod%' then 'iPod' else device\n        end as TEXT) as device,\n        sum(cast(quantity as bigint)) as quantity\n    from fields\n    group by 1,2,3,4,5,6,7,8,9\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.765629Z", "completed_at": "2024-07-23T15:57:04.785953Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.787860Z", "completed_at": "2024-07-23T15:57:04.787864Z"}], "thread_id": "Thread-8", "execution_time": 0.06891798973083496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__app_version_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__crashes_app_version as (\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day, \n        app_id,\n        app_version,\n        cast(null as TEXT) as source_type,\n        sum(crashes) as crashes\n    from base\n    group by 1,2,3,4,5\n)\n\nselect * \nfrom aggregated\n), app as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\ncrashes_app_version_report as (\n    \n    select *\n    from __dbt__cte__int_apple_store__crashes_app_version\n),\n\nusage_app_version_report as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_app_version\"\n),\n\nreporting_grain_combined as (\n    \n    select\n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        app_version\n    from usage_app_version_report\n    union all \n    select \n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        app_version\n    from crashes_app_version_report\n),\n\nreporting_grain as (\n\n    select \n        distinct *\n    from reporting_grain_combined\n),\n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.app_id, \n        app.app_name,\n        reporting_grain.source_type,\n        reporting_grain.app_version,\n        coalesce(crashes_app_version_report.crashes, 0) as crashes,\n        coalesce(usage_app_version_report.active_devices, 0) as active_devices,\n        coalesce(usage_app_version_report.active_devices_last_30_days, 0) as active_devices_last_30_days,\n        coalesce(usage_app_version_report.deletions, 0) as deletions,\n        coalesce(usage_app_version_report.installations, 0) as installations,\n        coalesce(usage_app_version_report.sessions, 0) as sessions\n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n        and reporting_grain.source_relation = app.source_relation\n    left join crashes_app_version_report\n        on reporting_grain.date_day = crashes_app_version_report.date_day\n        and reporting_grain.source_relation = crashes_app_version_report.source_relation\n        and reporting_grain.app_id = crashes_app_version_report.app_id\n        and reporting_grain.source_type = crashes_app_version_report.source_type\n        and reporting_grain.app_version = crashes_app_version_report.app_version\n    left join usage_app_version_report\n        on reporting_grain.date_day = usage_app_version_report.date_day\n        and reporting_grain.source_relation = usage_app_version_report.source_relation\n        and reporting_grain.app_id = usage_app_version_report.app_id \n        and reporting_grain.source_type = usage_app_version_report.source_type\n        and reporting_grain.app_version = usage_app_version_report.app_version\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__app_version_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:03.876636Z", "completed_at": "2024-07-23T15:57:04.717418Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.719435Z", "completed_at": "2024-07-23T15:57:04.719438Z"}], "thread_id": "Thread-4", "execution_time": 0.9264101982116699, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_territory", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_territory_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active_devices\n    \n as \n    \n    active_devices\n    \n, \n    \n    \n    active_devices_last_30_days\n    \n as \n    \n    active_devices_last_30_days\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    deletions\n    \n as \n    \n    deletions\n    \n, \n    \n    \n    installations\n    \n as \n    \n    installations\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    sessions\n    \n as \n    \n    sessions\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    territory\n    \n as \n    \n    territory\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(territory as TEXT) as territory,\n        cast(active_devices as bigint) as active_devices,\n        cast(active_devices_last_30_days as bigint) as active_devices_last_30_days,\n        cast(deletions as bigint) as deletions,\n        cast(installations as bigint) as installations,\n        cast(sessions as bigint) as sessions\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_territory\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.789176Z", "completed_at": "2024-07-23T15:57:04.799057Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.833344Z", "completed_at": "2024-07-23T15:57:04.833353Z"}], "thread_id": "Thread-2", "execution_time": 0.048243045806884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__sales_subscription_summary_source_relation__date_day__account_id__app_name__subscription_name__device__country__state.4c663eea8c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, app_name, subscription_name, device, country, state\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary\"\n    group by source_relation, date_day, account_id, app_name, subscription_name, device, country, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.794980Z", "completed_at": "2024-07-23T15:57:04.812179Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.833947Z", "completed_at": "2024-07-23T15:57:04.833950Z"}], "thread_id": "Thread-3", "execution_time": 0.04785895347595215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__usage_platform_version_source_relation__date_day__app_id__source_type__platform_version.c82550bed4", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, platform_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_platform_version\"\n    group by source_relation, date_day, app_id, source_type, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.799275Z", "completed_at": "2024-07-23T15:57:04.845441Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.853553Z", "completed_at": "2024-07-23T15:57:04.853558Z"}], "thread_id": "Thread-1", "execution_time": 0.06491303443908691, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__platform_version_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__platform_version as (\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_platform_version\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day, \n        app_id,\n        platform_version,\n        cast(null as TEXT) as source_type,\n        sum(crashes) as crashes\n    from base\n    group by 1,2,3,4,5\n)\n\nselect * \nfrom aggregated\n), app as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\napp_store_platform_version as (\n    \n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_platform_version\"\n),\n\ncrashes_platform_version as (\n    \n    select *\n    from __dbt__cte__int_apple_store__platform_version\n),\n\ndownloads_platform_version as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_platform_version\"\n),\n\nusage_platform_version as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_platform_version\"\n),\n\nreporting_grain_combined as (\n\n    select\n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        platform_version\n    from app_store_platform_version\n    union all\n    select \n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        platform_version\n    from crashes_platform_version\n),\n\nreporting_grain as (\n\n    select \n        distinct *\n    from reporting_grain_combined\n\n),\n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.app_id, \n        app.app_name,\n        reporting_grain.source_type,\n        reporting_grain.platform_version,\n        coalesce(app_store_platform_version.impressions, 0) as impressions,\n        coalesce(app_store_platform_version.impressions_unique_device, 0) as impressions_unique_device,\n        coalesce(app_store_platform_version.page_views, 0) as page_views,\n        coalesce(app_store_platform_version.page_views_unique_device, 0) as page_views_unique_device,\n        coalesce(crashes_platform_version.crashes, 0) as crashes,\n        coalesce(downloads_platform_version.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads_platform_version.redownloads, 0) as redownloads,\n        coalesce(downloads_platform_version.total_downloads, 0) as total_downloads,\n        coalesce(usage_platform_version.active_devices, 0) as active_devices,\n        coalesce(usage_platform_version.active_devices_last_30_days, 0) as active_devices_last_30_days,\n        coalesce(usage_platform_version.deletions, 0) as deletions,\n        coalesce(usage_platform_version.installations, 0) as installations,\n        coalesce(usage_platform_version.sessions, 0) as sessions\n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n        and reporting_grain.source_relation = app.source_relation\n    left join app_store_platform_version \n        on reporting_grain.date_day = app_store_platform_version.date_day\n        and reporting_grain.source_relation = app_store_platform_version.source_relation\n        and reporting_grain.app_id = app_store_platform_version.app_id \n        and reporting_grain.source_type = app_store_platform_version.source_type\n        and reporting_grain.platform_version = app_store_platform_version.platform_version\n    left join crashes_platform_version\n        on reporting_grain.date_day = crashes_platform_version.date_day\n        and reporting_grain.source_relation = crashes_platform_version.source_relation\n        and reporting_grain.app_id = crashes_platform_version.app_id\n        and reporting_grain.source_type = crashes_platform_version.source_type\n        and reporting_grain.platform_version = crashes_platform_version.platform_version    \n    left join downloads_platform_version\n        on reporting_grain.date_day = downloads_platform_version.date_day\n        and reporting_grain.source_relation = downloads_platform_version.source_relation\n        and reporting_grain.app_id = downloads_platform_version.app_id \n        and reporting_grain.source_type = downloads_platform_version.source_type\n        and reporting_grain.platform_version = downloads_platform_version.platform_version\n    left join usage_platform_version\n        on reporting_grain.date_day = usage_platform_version.date_day\n        and reporting_grain.source_relation = usage_platform_version.source_relation\n        and reporting_grain.app_id = usage_platform_version.app_id \n        and reporting_grain.source_type = usage_platform_version.source_type\n        and reporting_grain.platform_version = usage_platform_version.platform_version\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__platform_version_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.819248Z", "completed_at": "2024-07-23T15:57:04.849081Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.854356Z", "completed_at": "2024-07-23T15:57:04.854359Z"}], "thread_id": "Thread-6", "execution_time": 0.06547307968139648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__source_type_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__app_store_source_type as (\nwith base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        sum(impressions) as impressions,\n        sum(page_views) as page_views\n    from base \n    group by 1,2,3,4\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__downloads_source_type as (\nwith base as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        sum(first_time_downloads) as first_time_downloads,\n        sum(redownloads) as redownloads,\n        sum(total_downloads) as total_downloads\n    from base \n    group by 1,2,3,4\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__usage_source_type as (\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        sum(active_devices) as active_devices,\n        sum(deletions) as deletions,\n        sum(installations) as installations,\n        sum(sessions) as sessions\n    from base\n    group by 1,2,3,4\n)\n\nselect * \nfrom aggregated\n), app as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\napp_store_source_type as (\n\n    select *\n    from __dbt__cte__int_apple_store__app_store_source_type\n),\n\ndownloads_source_type as (\n\n    select *\n    from __dbt__cte__int_apple_store__downloads_source_type\n),\n\nusage_source_type as (\n\n    select *\n    from __dbt__cte__int_apple_store__usage_source_type\n),\n\nreporting_grain as (\n\n    select distinct\n        source_relation,\n        date_day,\n        app_id,\n        source_type\n    from app_store_source_type\n),\n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.app_id, \n        app.app_name,\n        reporting_grain.source_type,\n        coalesce(app_store_source_type.impressions, 0) as impressions,\n        coalesce(app_store_source_type.page_views, 0) as page_views,\n        coalesce(downloads_source_type.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads_source_type.redownloads, 0) as redownloads,\n        coalesce(downloads_source_type.total_downloads, 0) as total_downloads,\n        coalesce(usage_source_type.active_devices, 0) as active_devices,\n        coalesce(usage_source_type.deletions, 0) as deletions,\n        coalesce(usage_source_type.installations, 0) as installations,\n        coalesce(usage_source_type.sessions, 0) as sessions\n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n        and reporting_grain.source_relation = app.source_relation\n    left join app_store_source_type\n        on reporting_grain.date_day = app_store_source_type.date_day\n        and reporting_grain.source_relation = app_store_source_type.source_relation\n        and reporting_grain.app_id = app_store_source_type.app_id \n        and reporting_grain.source_type = app_store_source_type.source_type\n    left join downloads_source_type\n        on reporting_grain.date_day = downloads_source_type.date_day\n        and reporting_grain.source_relation = downloads_source_type.source_relation\n        and reporting_grain.app_id = downloads_source_type.app_id \n        and reporting_grain.source_type = downloads_source_type.source_type\n    left join usage_source_type\n        on reporting_grain.date_day = usage_source_type.date_day\n        and reporting_grain.source_relation = usage_source_type.source_relation\n        and reporting_grain.app_id = usage_source_type.app_id \n        and reporting_grain.source_type = usage_source_type.source_type\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__source_type_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.845718Z", "completed_at": "2024-07-23T15:57:04.855510Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.858375Z", "completed_at": "2024-07-23T15:57:04.858381Z"}], "thread_id": "Thread-7", "execution_time": 0.05970621109008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__sales_subscription_events_source_relation__date_day__account_id__app_name__subscription_name__device__event__country__state.89b9a03f45", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, app_name, subscription_name, device, event, country, state\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events\"\n    group by source_relation, date_day, account_id, app_name, subscription_name, device, event, country, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.849300Z", "completed_at": "2024-07-23T15:57:04.856141Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.859168Z", "completed_at": "2024-07-23T15:57:04.859174Z"}], "thread_id": "Thread-4", "execution_time": 0.04733896255493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__territory_report", "compiled": true, "compiled_code": "with app as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\napp_store_territory as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_territory\"\n),\n\ncountry_codes as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_source\".\"apple_store_country_codes\"\n),\n\ndownloads_territory as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_territory\"\n),\n\nusage_territory as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_territory\"\n),\n\nreporting_grain as (\n\n    select distinct\n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        territory \n    from app_store_territory\n),\n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.app_id,\n        app.app_name,\n        reporting_grain.source_type,\n        reporting_grain.territory as territory_long,\n        coalesce(official_country_codes.country_code_alpha_2, alternative_country_codes.country_code_alpha_2) as territory_short,\n        coalesce(official_country_codes.region, alternative_country_codes.region) as region,\n        coalesce(official_country_codes.sub_region, alternative_country_codes.sub_region) as sub_region,\n        coalesce(app_store_territory.impressions, 0) as impressions,\n        coalesce(app_store_territory.impressions_unique_device, 0) as impressions_unique_device,\n        coalesce(app_store_territory.page_views, 0) as page_views,\n        coalesce(app_store_territory.page_views_unique_device, 0) as page_views_unique_device,\n        coalesce(downloads_territory.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads_territory.redownloads, 0) as redownloads,\n        coalesce(downloads_territory.total_downloads, 0) as total_downloads,\n        coalesce(usage_territory.active_devices, 0) as active_devices,\n        coalesce(usage_territory.active_devices_last_30_days, 0) as active_devices_last_30_days,\n        coalesce(usage_territory.deletions, 0) as deletions,\n        coalesce(usage_territory.installations, 0) as installations,\n        coalesce(usage_territory.sessions, 0) as sessions\n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n        and reporting_grain.source_relation = app.source_relation\n    left join app_store_territory \n        on reporting_grain.date_day = app_store_territory.date_day\n        and reporting_grain.source_relation = app_store_territory.source_relation\n        and reporting_grain.app_id = app_store_territory.app_id \n        and reporting_grain.source_type = app_store_territory.source_type\n        and reporting_grain.territory = app_store_territory.territory\n    left join downloads_territory\n        on reporting_grain.date_day = downloads_territory.date_day\n        and reporting_grain.source_relation = downloads_territory.source_relation\n        and reporting_grain.app_id = downloads_territory.app_id \n        and reporting_grain.source_type = downloads_territory.source_type\n        and reporting_grain.territory = downloads_territory.territory\n    left join usage_territory\n        on reporting_grain.date_day = usage_territory.date_day\n        and reporting_grain.source_relation = usage_territory.source_relation\n        and reporting_grain.app_id = usage_territory.app_id \n        and reporting_grain.source_type = usage_territory.source_type\n        and reporting_grain.territory = usage_territory.territory\n    left join country_codes as official_country_codes\n        on reporting_grain.territory = official_country_codes.country_name\n    left join country_codes as alternative_country_codes\n        on reporting_grain.territory = alternative_country_codes.alternative_country_name\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__territory_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.859851Z", "completed_at": "2024-07-23T15:57:04.875054Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.911662Z", "completed_at": "2024-07-23T15:57:04.911669Z"}], "thread_id": "Thread-2", "execution_time": 0.05768895149230957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__usage_territory_source_relation__date_day__app_id__source_type__territory.2028f8f100", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, territory\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_territory\"\n    group by source_relation, date_day, app_id, source_type, territory\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.865532Z", "completed_at": "2024-07-23T15:57:04.905921Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.912458Z", "completed_at": "2024-07-23T15:57:04.912462Z"}], "thread_id": "Thread-3", "execution_time": 0.05669593811035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__app_version_report_source_relation__date_day__app_id__source_type__app_version.e43e9ef143", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, app_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__app_version_report\"\n    group by source_relation, date_day, app_id, source_type, app_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.875299Z", "completed_at": "2024-07-23T15:57:04.919006Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.944833Z", "completed_at": "2024-07-23T15:57:04.944837Z"}], "thread_id": "Thread-1", "execution_time": 0.0853278636932373, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__platform_version_report_source_relation__date_day__app_id__source_type__platform_version.f053b826be", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, platform_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__platform_version_report\"\n    group by source_relation, date_day, app_id, source_type, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.881252Z", "completed_at": "2024-07-23T15:57:04.928560Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.945280Z", "completed_at": "2024-07-23T15:57:04.945284Z"}], "thread_id": "Thread-5", "execution_time": 0.08068299293518066, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__subscription_report", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_apple_store__sales_subscription_summary as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary\"\n),\n\napp as (\n    \n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\nsales_account as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account\"\n),\n\njoined as (\n\n    select \n        base.source_relation,\n        base.date_day,\n        base.account_id,\n        sales_account.account_name,\n        app.app_id,\n        base.app_name,\n        base.subscription_name,\n        base.country,\n        base.state,\n        sum(base.active_free_trial_introductory_offer_subscriptions) as active_free_trial_introductory_offer_subscriptions,\n        sum(base.active_pay_as_you_go_introductory_offer_subscriptions) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(base.active_pay_up_front_introductory_offer_subscriptions) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(base.active_standard_price_subscriptions) as active_standard_price_subscriptions\n    from base\n    left join app \n        on base.app_name = app.app_name\n        and base.source_relation = app.source_relation\n    left join sales_account \n        on base.account_id = sales_account.account_id\n        and base.source_relation = sales_account.source_relation\n    group by 1,2,3,4,5,6,7,8,9\n)\n\nselect * \nfrom joined\n),  __dbt__cte__int_apple_store__sales_subscription_events as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events\"\n),\n\napp as (\n    \n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\nsales_account as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account\"\n),\n\nfiltered as (\n\n    select *\n    from base \n    where lower(event)\n        in (\n            \n                \n                'renew'\n            \n                \n                , \n                \n                'cancel'\n            \n                \n                , \n                \n                'subscribe'\n               \n        )\n),\n\npivoted as (\n    \n    select\n        date_day\n        , source_relation\n        , account_id\n        , app_name\n        , subscription_name\n        , country\n        , state\n        \n        , sum(case when lower(event) = 'renew' then quantity else 0 end) as event_renew\n        \n        , sum(case when lower(event) = 'cancel' then quantity else 0 end) as event_cancel\n        \n        , sum(case when lower(event) = 'subscribe' then quantity else 0 end) as event_subscribe\n        \n    from filtered\n    group by 1,2,3,4,5,6,7\n),\n\njoined as (\n\n    select \n        pivoted.source_relation,\n        pivoted.date_day,\n        pivoted.account_id,\n        sales_account.account_name,\n        app.app_id,\n        pivoted.app_name,\n        pivoted.subscription_name,\n        pivoted.country,\n        pivoted.state\n        \n        , pivoted.event_renew\n        \n        , pivoted.event_cancel\n        \n        , pivoted.event_subscribe\n        \n    from pivoted\n    left join app \n        on pivoted.app_name = app.app_name\n        and pivoted.source_relation = app.source_relation\n    left join sales_account \n        on pivoted.account_id = sales_account.account_id\n        and pivoted.source_relation = sales_account.source_relation\n)\n\nselect * \nfrom joined\n), subscription_summary as (\n\n    select *\n    from __dbt__cte__int_apple_store__sales_subscription_summary\n),\n\nsubscription_events as (\n\n    select *\n    from __dbt__cte__int_apple_store__sales_subscription_events\n),\n\ncountry_codes as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_source\".\"apple_store_country_codes\"\n),\n\nreporting_grain_combined as (\n\n    select\n        source_relation,\n        cast(date_day as date) as date_day,\n        account_id,\n        account_name,\n        app_name,\n        app_id,\n        subscription_name,\n        country,\n        state \n    from subscription_summary\n    union all\n    select\n        source_relation,\n        cast(date_day as date) as date_day,\n        account_id,\n        account_name,\n        app_name,\n        app_id,\n        subscription_name,\n        country,\n        state \n    from subscription_events\n),\n\nreporting_grain as (\n\n    select \n        distinct *\n    from reporting_grain_combined\n),\n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.account_id,\n        reporting_grain.account_name, \n        reporting_grain.app_id,\n        reporting_grain.app_name,\n        reporting_grain.subscription_name, \n        case \n            when country_codes.alternative_country_name is null then country_codes.country_name\n            else country_codes.alternative_country_name\n        end as territory_long,\n        reporting_grain.country as territory_short,\n        reporting_grain.state,\n        country_codes.region, \n        country_codes.sub_region,\n        coalesce(subscription_summary.active_free_trial_introductory_offer_subscriptions, 0) as active_free_trial_introductory_offer_subscriptions,\n        coalesce(subscription_summary.active_pay_as_you_go_introductory_offer_subscriptions, 0) as active_pay_as_you_go_introductory_offer_subscriptions,\n        coalesce(subscription_summary.active_pay_up_front_introductory_offer_subscriptions, 0) as active_pay_up_front_introductory_offer_subscriptions,\n        coalesce(subscription_summary.active_standard_price_subscriptions, 0) as active_standard_price_subscriptions\n        \n        \n        , coalesce(subscription_events.event_renew, 0)\n            as event_renew \n        \n        \n        , coalesce(subscription_events.event_cancel, 0)\n            as event_cancel \n        \n        \n        , coalesce(subscription_events.event_subscribe, 0)\n            as event_subscribe \n        \n    from reporting_grain\n    left join subscription_summary\n        on reporting_grain.date_day = subscription_summary.date_day\n        and reporting_grain.source_relation = subscription_summary.source_relation\n        and reporting_grain.account_id =  subscription_summary.account_id \n        and reporting_grain.app_name = subscription_summary.app_name\n        and reporting_grain.subscription_name = subscription_summary.subscription_name\n        and reporting_grain.country = subscription_summary.country\n        and (reporting_grain.state = subscription_summary.state or (reporting_grain.state is null and subscription_summary.state is null))\n    left join subscription_events\n        on reporting_grain.date_day = subscription_events.date_day\n        and reporting_grain.source_relation = subscription_events.source_relation\n        and reporting_grain.account_id =  subscription_events.account_id \n        and reporting_grain.app_name = subscription_events.app_name\n        and reporting_grain.subscription_name = subscription_events.subscription_name\n        and reporting_grain.country = subscription_events.country\n        and (reporting_grain.state = subscription_events.state or (reporting_grain.state is null and subscription_events.state is null))\n    left join country_codes\n        on reporting_grain.country = country_codes.country_code_alpha_2\n    \n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__subscription_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.878549Z", "completed_at": "2024-07-23T15:57:04.944233Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.945701Z", "completed_at": "2024-07-23T15:57:04.945705Z"}], "thread_id": "Thread-6", "execution_time": 0.08147215843200684, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__source_type_report_source_relation__date_day__app_id__source_type.5f6e6bf648", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__source_type_report\"\n    group by source_relation, date_day, app_id, source_type\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.919233Z", "completed_at": "2024-07-23T15:57:04.946377Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.947398Z", "completed_at": "2024-07-23T15:57:04.947402Z"}], "thread_id": "Thread-4", "execution_time": 0.06918883323669434, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__territory_report_source_relation__date_day__app_id__source_type__territory_long.1f8ce77eb8", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, territory_long\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__territory_report\"\n    group by source_relation, date_day, app_id, source_type, territory_long\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.913028Z", "completed_at": "2024-07-23T15:57:04.946642Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.947752Z", "completed_at": "2024-07-23T15:57:04.947756Z"}], "thread_id": "Thread-7", "execution_time": 0.07308506965637207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__device_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__crashes_device as (\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day, \n        app_id,\n        device,\n        cast(null as TEXT) as source_type,\n        sum(crashes) as crashes\n    from base\n    group by 1,2,3,4,5\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__subscription_device as (\n\n\nwith app as (\n    \n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\nsubscription_summary as (\n\n    select\n        source_relation,\n        date_day,\n        app_name,\n        device,\n        sum(active_free_trial_introductory_offer_subscriptions) as active_free_trial_introductory_offer_subscriptions,\n        sum(active_pay_as_you_go_introductory_offer_subscriptions) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(active_pay_up_front_introductory_offer_subscriptions) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(active_standard_price_subscriptions) as active_standard_price_subscriptions\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary\"\n    group by 1,2,3,4\n), \n\nfiltered_subscription_events as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events\" \n    where lower(event)\n        in (\n            \n                \n                'renew'\n            \n                \n                , \n                \n                'cancel'\n            \n                \n                , \n                \n                'subscribe'\n               \n        )\n),\n\npivoted_subscription_events as (\n    \n    select\n        source_relation,\n        date_day,\n        app_name,\n        device\n        \n        , sum(case when lower(event) = 'renew' then quantity else 0 end) as event_renew\n        \n        , sum(case when lower(event) = 'cancel' then quantity else 0 end) as event_cancel\n        \n        , sum(case when lower(event) = 'subscribe' then quantity else 0 end) as event_subscribe\n        \n    from filtered_subscription_events\n    group by 1,2,3,4\n),\n\njoined as (\n\n    select \n        app.app_id,\n        pivoted_subscription_events.*,\n        subscription_summary.active_free_trial_introductory_offer_subscriptions,\n        subscription_summary.active_pay_as_you_go_introductory_offer_subscriptions,\n        subscription_summary.active_pay_up_front_introductory_offer_subscriptions,\n        subscription_summary.active_standard_price_subscriptions,\n        cast(null as TEXT) as source_type\n    from subscription_summary \n    left join pivoted_subscription_events\n        on subscription_summary.date_day = pivoted_subscription_events.date_day\n        and subscription_summary.source_relation = pivoted_subscription_events.source_relation\n        and subscription_summary.app_name = pivoted_subscription_events.app_name\n        and subscription_summary.device = pivoted_subscription_events.device\n    left join app \n        on subscription_summary.app_name = app.app_name\n        and subscription_summary.source_relation = app.source_relation\n)\n\nselect * \nfrom joined\n), app as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\napp_store_device as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device\"\n),\n\ndownloads_device as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device\"\n),\n\nusage_device as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device\"\n),\n\ncrashes_device as (\n\n    select *\n    from __dbt__cte__int_apple_store__crashes_device\n),\n\n\nsubscription_device as (\n\n    select *\n    from __dbt__cte__int_apple_store__subscription_device\n),\n\n\nreporting_grain_combined as (\n\n    select\n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        device \n    from app_store_device\n    union all\n    select\n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        device\n    from crashes_device\n),\n\nreporting_grain as (\n    \n    select\n        distinct *\n    from reporting_grain_combined\n),\n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.app_id, \n        app.app_name,\n        reporting_grain.source_type,\n        reporting_grain.device,\n        coalesce(app_store_device.impressions, 0) as impressions,\n        coalesce(app_store_device.impressions_unique_device, 0) as impressions_unique_device,\n        coalesce(app_store_device.page_views, 0) as page_views,\n        coalesce(app_store_device.page_views_unique_device, 0) as page_views_unique_device,\n        coalesce(crashes_device.crashes, 0) as crashes,\n        coalesce(downloads_device.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads_device.redownloads, 0) as redownloads,\n        coalesce(downloads_device.total_downloads, 0) as total_downloads,\n        coalesce(usage_device.active_devices, 0) as active_devices,\n        coalesce(usage_device.active_devices_last_30_days, 0) as active_devices_last_30_days,\n        coalesce(usage_device.deletions, 0) as deletions,\n        coalesce(usage_device.installations, 0) as installations,\n        coalesce(usage_device.sessions, 0) as sessions\n        \n        ,\n        coalesce(subscription_device.active_free_trial_introductory_offer_subscriptions, 0) as active_free_trial_introductory_offer_subscriptions,\n        coalesce(subscription_device.active_pay_as_you_go_introductory_offer_subscriptions, 0) as active_pay_a_you_go_introductory_offer_subscriptions,\n        coalesce(subscription_device.active_pay_up_front_introductory_offer_subscriptions, 0) as active_pay_up_front_introductory_offer_subscriptions,\n        coalesce(subscription_device.active_standard_price_subscriptions, 0) as active_standard_price_subscriptions\n        \n        \n        , coalesce(subscription_device.event_renew, 0)\n            as event_renew \n        \n        \n        , coalesce(subscription_device.event_cancel, 0)\n            as event_cancel \n        \n        \n        , coalesce(subscription_device.event_subscribe, 0)\n            as event_subscribe \n        \n        \n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n        and reporting_grain.source_relation = app.source_relation\n    left join app_store_device \n        on reporting_grain.date_day = app_store_device.date_day\n        and reporting_grain.source_relation = app_store_device.source_relation\n        and reporting_grain.app_id = app_store_device.app_id \n        and reporting_grain.source_type = app_store_device.source_type\n        and reporting_grain.device = app_store_device.device\n    left join crashes_device\n        on reporting_grain.date_day = crashes_device.date_day\n        and reporting_grain.source_relation = crashes_device.source_relation\n        and reporting_grain.app_id = crashes_device.app_id\n        and reporting_grain.source_type = crashes_device.source_type\n        and reporting_grain.device = crashes_device.device\n    left join downloads_device\n        on reporting_grain.date_day = downloads_device.date_day\n        and reporting_grain.source_relation = downloads_device.source_relation\n        and reporting_grain.app_id = downloads_device.app_id \n        and reporting_grain.source_type = downloads_device.source_type\n        and reporting_grain.device = downloads_device.device\n    \n    left join subscription_device\n        on reporting_grain.date_day = subscription_device.date_day\n        and reporting_grain.source_relation = subscription_device.source_relation\n        and reporting_grain.app_id = subscription_device.app_id \n        and reporting_grain.source_type = subscription_device.source_type\n        and reporting_grain.device = subscription_device.device\n    \n    left join usage_device\n        on reporting_grain.date_day = usage_device.date_day\n        and reporting_grain.source_relation = usage_device.source_relation\n        and reporting_grain.app_id = usage_device.app_id \n        and reporting_grain.source_type = usage_device.source_type\n        and reporting_grain.device = usage_device.device\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__device_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.968893Z", "completed_at": "2024-07-23T15:57:04.975092Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.975316Z", "completed_at": "2024-07-23T15:57:04.975321Z"}], "thread_id": "Thread-8", "execution_time": 0.027302265167236328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__subscription_report_source_relation__date_day__account_id__app_id__subscription_name__territory_long__state.77cd2fc10f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, app_id, subscription_name, territory_long, state\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__subscription_report\"\n    group by source_relation, date_day, account_id, app_id, subscription_name, territory_long, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.948301Z", "completed_at": "2024-07-23T15:57:04.975718Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.975930Z", "completed_at": "2024-07-23T15:57:04.975933Z"}], "thread_id": "Thread-2", "execution_time": 0.02989816665649414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__overview_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__app_store_overview as (\nwith base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day,\n        app_id,\n        sum(impressions) as impressions,\n        sum(page_views) as page_views\n    from base \n    group by 1,2,3\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__crashes_overview as (\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day, \n        app_id,\n        sum(crashes) as crashes\n    from base\n    group by 1,2,3\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__downloads_overview as (\nwith base as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day,\n        app_id,\n        sum(first_time_downloads) as first_time_downloads,\n        sum(redownloads) as redownloads,\n        sum(total_downloads) as total_downloads\n    from base \n    group by 1,2,3\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__sales_subscription_summary as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary\"\n),\n\napp as (\n    \n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\nsales_account as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account\"\n),\n\njoined as (\n\n    select \n        base.source_relation,\n        base.date_day,\n        base.account_id,\n        sales_account.account_name,\n        app.app_id,\n        base.app_name,\n        base.subscription_name,\n        base.country,\n        base.state,\n        sum(base.active_free_trial_introductory_offer_subscriptions) as active_free_trial_introductory_offer_subscriptions,\n        sum(base.active_pay_as_you_go_introductory_offer_subscriptions) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(base.active_pay_up_front_introductory_offer_subscriptions) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(base.active_standard_price_subscriptions) as active_standard_price_subscriptions\n    from base\n    left join app \n        on base.app_name = app.app_name\n        and base.source_relation = app.source_relation\n    left join sales_account \n        on base.account_id = sales_account.account_id\n        and base.source_relation = sales_account.source_relation\n    group by 1,2,3,4,5,6,7,8,9\n)\n\nselect * \nfrom joined\n),  __dbt__cte__int_apple_store__sales_subscription_events as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events\"\n),\n\napp as (\n    \n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\nsales_account as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account\"\n),\n\nfiltered as (\n\n    select *\n    from base \n    where lower(event)\n        in (\n            \n                \n                'renew'\n            \n                \n                , \n                \n                'cancel'\n            \n                \n                , \n                \n                'subscribe'\n               \n        )\n),\n\npivoted as (\n    \n    select\n        date_day\n        , source_relation\n        , account_id\n        , app_name\n        , subscription_name\n        , country\n        , state\n        \n        , sum(case when lower(event) = 'renew' then quantity else 0 end) as event_renew\n        \n        , sum(case when lower(event) = 'cancel' then quantity else 0 end) as event_cancel\n        \n        , sum(case when lower(event) = 'subscribe' then quantity else 0 end) as event_subscribe\n        \n    from filtered\n    group by 1,2,3,4,5,6,7\n),\n\njoined as (\n\n    select \n        pivoted.source_relation,\n        pivoted.date_day,\n        pivoted.account_id,\n        sales_account.account_name,\n        app.app_id,\n        pivoted.app_name,\n        pivoted.subscription_name,\n        pivoted.country,\n        pivoted.state\n        \n        , pivoted.event_renew\n        \n        , pivoted.event_cancel\n        \n        , pivoted.event_subscribe\n        \n    from pivoted\n    left join app \n        on pivoted.app_name = app.app_name\n        and pivoted.source_relation = app.source_relation\n    left join sales_account \n        on pivoted.account_id = sales_account.account_id\n        and pivoted.source_relation = sales_account.source_relation\n)\n\nselect * \nfrom joined\n),  __dbt__cte__int_apple_store__sales_subscription_overview as (\n\n\nwith subscription_summary as (\n\n    select\n        source_relation,\n        date_day,\n        app_id,\n        sum(active_free_trial_introductory_offer_subscriptions) as active_free_trial_introductory_offer_subscriptions,\n        sum(active_pay_as_you_go_introductory_offer_subscriptions) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(active_pay_up_front_introductory_offer_subscriptions) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(active_standard_price_subscriptions) as active_standard_price_subscriptions\n    from __dbt__cte__int_apple_store__sales_subscription_summary\n    group by 1,2,3\n), \n\nsubscription_events as (\n\n    select \n        source_relation,\n        date_day,\n        app_id\n        \n        \n        , coalesce(sum(event_renew), 0)\n            as event_renew \n        \n        \n        , coalesce(sum(event_cancel), 0)\n            as event_cancel \n        \n        \n        , coalesce(sum(event_subscribe), 0)\n            as event_subscribe \n        \n    from __dbt__cte__int_apple_store__sales_subscription_events\n    group by 1,2,3\n), \n\njoined as (\n\n    select \n        subscription_events.*,\n        active_free_trial_introductory_offer_subscriptions,\n        active_pay_as_you_go_introductory_offer_subscriptions,\n        active_pay_up_front_introductory_offer_subscriptions,\n        active_standard_price_subscriptions\n    from subscription_summary \n    left join subscription_events\n        on subscription_summary.date_day = subscription_events.date_day\n        and subscription_summary.source_relation = subscription_events.source_relation\n        and subscription_summary.app_id = subscription_events.app_id \n)\n\nselect * \nfrom joined\n),  __dbt__cte__int_apple_store__usage_overview as (\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day,\n        app_id,\n        sum(active_devices) as active_devices,\n        sum(deletions) as deletions,\n        sum(installations) as installations,\n        sum(sessions) as sessions\n    from base\n    group by 1,2,3\n)\n\nselect * \nfrom aggregated\n), app as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\napp_store as (\n\n    select *\n    from __dbt__cte__int_apple_store__app_store_overview\n),\n\ncrashes as (\n\n    select *\n    from __dbt__cte__int_apple_store__crashes_overview\n),\n\ndownloads as (\n\n    select *\n    from __dbt__cte__int_apple_store__downloads_overview\n),\n\n\nsubscriptions as (\n\n    select *\n    from __dbt__cte__int_apple_store__sales_subscription_overview\n), \n\n\nusage as (\n\n    select *\n    from __dbt__cte__int_apple_store__usage_overview\n),\n\nreporting_grain as (\n\n    select distinct\n        source_relation,\n        date_day,\n        app_id \n    from app_store\n), \n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.app_id,\n        app.app_name,\n        coalesce(app_store.impressions, 0) as impressions,\n        coalesce(app_store.page_views, 0) as page_views,\n        coalesce(crashes.crashes,0) as crashes,\n        coalesce(downloads.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads.redownloads, 0) as redownloads,\n        coalesce(downloads.total_downloads, 0) as total_downloads,\n        coalesce(usage.active_devices, 0) as active_devices,\n        coalesce(usage.deletions, 0) as deletions,\n        coalesce(usage.installations, 0) as installations,\n        coalesce(usage.sessions, 0) as sessions\n        \n        ,\n        coalesce(subscriptions.active_free_trial_introductory_offer_subscriptions, 0) as active_free_trial_introductory_offer_subscriptions,\n        coalesce(subscriptions.active_pay_as_you_go_introductory_offer_subscriptions, 0) as active_pay_as_you_go_introductory_offer_subscriptions,\n        coalesce(subscriptions.active_pay_up_front_introductory_offer_subscriptions, 0) as active_pay_up_front_introductory_offer_subscriptions,\n        coalesce(subscriptions.active_standard_price_subscriptions, 0) as active_standard_price_subscriptions\n        \n        \n        , coalesce(subscriptions.event_renew, 0)\n            as event_renew \n        \n        \n        , coalesce(subscriptions.event_cancel, 0)\n            as event_cancel \n        \n        \n        , coalesce(subscriptions.event_subscribe, 0)\n            as event_subscribe \n        \n        \n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n        and reporting_grain.source_relation = app.source_relation\n    left join app_store \n        on reporting_grain.date_day = app_store.date_day\n        and reporting_grain.source_relation = app_store.source_relation\n        and reporting_grain.app_id = app_store.app_id\n    left join crashes\n        on reporting_grain.date_day = crashes.date_day\n        and reporting_grain.source_relation = crashes.source_relation\n        and reporting_grain.app_id = crashes.app_id\n    left join downloads\n        on reporting_grain.date_day = downloads.date_day\n        and reporting_grain.source_relation = downloads.source_relation\n        and reporting_grain.app_id = downloads.app_id\n    \n    left join subscriptions \n        on reporting_grain.date_day = subscriptions.date_day\n        and reporting_grain.source_relation = subscriptions.source_relation\n        and reporting_grain.app_id = subscriptions.app_id\n    \n    left join usage\n        on reporting_grain.date_day = usage.date_day\n        and reporting_grain.source_relation = usage.source_relation\n        and reporting_grain.app_id = usage.app_id        \n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__overview_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.972198Z", "completed_at": "2024-07-23T15:57:04.976850Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.977255Z", "completed_at": "2024-07-23T15:57:04.977258Z"}], "thread_id": "Thread-1", "execution_time": 0.005645036697387695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__device_report_source_relation__date_day__app_id__source_type__device.c04feac50f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, device\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__device_report\"\n    group by source_relation, date_day, app_id, source_type, device\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T15:57:04.977596Z", "completed_at": "2024-07-23T15:57:04.981356Z"}, {"name": "execute", "started_at": "2024-07-23T15:57:04.981574Z", "completed_at": "2024-07-23T15:57:04.981578Z"}], "thread_id": "Thread-6", "execution_time": 0.0050318241119384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__overview_report_source_relation__date_day__app_id.22a03a68cc", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__overview_report\"\n    group by source_relation, date_day, app_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}], "elapsed_time": 5.422065019607544, "args": {"select": [], "exclude": [], "empty_catalog": false, "require_resource_names_without_spaces": false, "invocation_command": "dbt docs generate", "log_format": "default", "source_freshness_run_project_hooks": false, "strict_mode": false, "log_path": "/Users/catherinefritz/Documents/dbt_packages/apple_store/dbt_apple_store/integration_tests/logs", "use_colors": true, "show_resource_report": false, "send_anonymous_usage_stats": true, "compile": true, "vars": {}, "write_json": true, "printer_width": 80, "require_explicit_package_overrides_for_builtin_materializations": true, "cache_selected_only": false, "warn_error_options": {"include": [], "exclude": []}, "populate_cache": true, "static": false, "project_dir": "/Users/catherinefritz/Documents/dbt_packages/apple_store/dbt_apple_store/integration_tests", "which": "generate", "log_format_file": "debug", "static_parser": true, "enable_legacy_logger": false, "log_level_file": "debug", "macro_debugging": false, "introspect": true, "indirect_selection": "eager", "defer": false, "quiet": false, "favor_state": false, "use_colors_file": true, "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "print": true, "partial_parse": true, "version_check": true, "log_level": "info", "profiles_dir": "/Users/catherinefritz/.dbt"}}