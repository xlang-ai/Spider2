{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-07-08T22:34:01.293991Z", "invocation_id": "6fb4cfff-56c7-4a02-9c92-5cc603b65b48", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.821718Z", "completed_at": "2024-07-08T22:33:59.862236Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.863853Z", "completed_at": "2024-07-08T22:33:59.863872Z"}], "thread_id": "Thread-3", "execution_time": 0.06754302978515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_group_criterion_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3`.`ad_group_criterion_history_data`", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_criterion_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.800363Z", "completed_at": "2024-07-08T22:33:59.862590Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.864572Z", "completed_at": "2024-07-08T22:33:59.864575Z"}], "thread_id": "Thread-1", "execution_time": 0.07072782516479492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__account_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3`.`account_history_data`", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__account_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.847763Z", "completed_at": "2024-07-08T22:33:59.863114Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.865410Z", "completed_at": "2024-07-08T22:33:59.865413Z"}], "thread_id": "Thread-4", "execution_time": 0.06805896759033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_group_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3`.`ad_group_history_data`", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.808715Z", "completed_at": "2024-07-08T22:33:59.863359Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.865668Z", "completed_at": "2024-07-08T22:33:59.865670Z"}], "thread_id": "Thread-2", "execution_time": 0.0706477165222168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__account_stats_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3`.`account_stats_data`", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__account_stats_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.870699Z", "completed_at": "2024-07-08T22:33:59.882765Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.883686Z", "completed_at": "2024-07-08T22:33:59.883691Z"}], "thread_id": "Thread-3", "execution_time": 0.01669907569885254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_group_stats_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3`.`ad_group_stats_data`", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_stats_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.874132Z", "completed_at": "2024-07-08T22:33:59.883379Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.885234Z", "completed_at": "2024-07-08T22:33:59.885237Z"}], "thread_id": "Thread-1", "execution_time": 0.01738595962524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3`.`ad_history_data`", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.879884Z", "completed_at": "2024-07-08T22:33:59.884213Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.886777Z", "completed_at": "2024-07-08T22:33:59.886780Z"}], "thread_id": "Thread-2", "execution_time": 0.018854856491088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3`.`campaign_history_data`", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__campaign_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.877079Z", "completed_at": "2024-07-08T22:33:59.884980Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.888219Z", "completed_at": "2024-07-08T22:33:59.888222Z"}], "thread_id": "Thread-4", "execution_time": 0.020006179809570312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_stats_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3`.`ad_stats_data`", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_stats_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.890731Z", "completed_at": "2024-07-08T22:33:59.898272Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.902303Z", "completed_at": "2024-07-08T22:33:59.902307Z"}], "thread_id": "Thread-3", "execution_time": 0.016429901123046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__campaign_stats_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3`.`campaign_stats_data`", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__campaign_stats_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.898571Z", "completed_at": "2024-07-08T22:33:59.899712Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.902777Z", "completed_at": "2024-07-08T22:33:59.902780Z"}], "thread_id": "Thread-2", "execution_time": 0.010129928588867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_source_integration_tests.account_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.900001Z", "completed_at": "2024-07-08T22:33:59.901075Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.903030Z", "completed_at": "2024-07-08T22:33:59.903032Z"}], "thread_id": "Thread-4", "execution_time": 0.010185956954956055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_source_integration_tests.account_stats_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.895010Z", "completed_at": "2024-07-08T22:33:59.901614Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.903810Z", "completed_at": "2024-07-08T22:33:59.903813Z"}], "thread_id": "Thread-1", "execution_time": 0.015502214431762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__keyword_stats_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3`.`keyword_stats_data`", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__keyword_stats_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.908921Z", "completed_at": "2024-07-08T22:33:59.910110Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.916066Z", "completed_at": "2024-07-08T22:33:59.916069Z"}], "thread_id": "Thread-3", "execution_time": 0.010805130004882812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_source_integration_tests.ad_group_criterion_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.910614Z", "completed_at": "2024-07-08T22:33:59.912431Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.916537Z", "completed_at": "2024-07-08T22:33:59.916539Z"}], "thread_id": "Thread-2", "execution_time": 0.010877847671508789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_source_integration_tests.ad_group_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.912705Z", "completed_at": "2024-07-08T22:33:59.913754Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.916790Z", "completed_at": "2024-07-08T22:33:59.916793Z"}], "thread_id": "Thread-4", "execution_time": 0.010946989059448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_source_integration_tests.ad_group_stats_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.914255Z", "completed_at": "2024-07-08T22:33:59.915346Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.917537Z", "completed_at": "2024-07-08T22:33:59.917540Z"}], "thread_id": "Thread-1", "execution_time": 0.011029958724975586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_source_integration_tests.ad_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.922276Z", "completed_at": "2024-07-08T22:33:59.923432Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.929171Z", "completed_at": "2024-07-08T22:33:59.929174Z"}], "thread_id": "Thread-3", "execution_time": 0.010375022888183594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_source_integration_tests.ad_stats_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.923907Z", "completed_at": "2024-07-08T22:33:59.924950Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.929635Z", "completed_at": "2024-07-08T22:33:59.929638Z"}], "thread_id": "Thread-2", "execution_time": 0.010493993759155273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_source_integration_tests.campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.925218Z", "completed_at": "2024-07-08T22:33:59.926944Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.929877Z", "completed_at": "2024-07-08T22:33:59.929880Z"}], "thread_id": "Thread-4", "execution_time": 0.01059103012084961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_source_integration_tests.campaign_stats_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.927423Z", "completed_at": "2024-07-08T22:33:59.928460Z"}, {"name": "execute", "started_at": "2024-07-08T22:33:59.930609Z", "completed_at": "2024-07-08T22:33:59.930611Z"}], "thread_id": "Thread-1", "execution_time": 0.010734796524047852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_source_integration_tests.keyword_stats_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.935326Z", "completed_at": "2024-07-08T22:34:00.282403Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.283104Z", "completed_at": "2024-07-08T22:34:00.283112Z"}], "thread_id": "Thread-3", "execution_time": 0.35070204734802246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_group_criterion_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_criterion_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    base_campaign_id\n    \n as \n    \n    base_campaign_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    keyword_match_type\n    \n as \n    \n    keyword_match_type\n    \n, \n    \n    \n    keyword_text\n    \n as \n    \n    keyword_text\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_active\n    \n \n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as criterion_id,\n        cast(ad_group_id as string) as ad_group_id,\n        base_campaign_id,\n        updated_at,\n        type,\n        status,\n        keyword_match_type,\n        keyword_text,\n        row_number() over (partition by source_relation, id order by updated_at desc) = 1 as is_most_recent_record\n    from fields\n    where coalesce(_fivetran_active, true)\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_criterion_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.938587Z", "completed_at": "2024-07-08T22:34:00.333571Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.334262Z", "completed_at": "2024-07-08T22:34:00.334269Z"}], "thread_id": "Thread-2", "execution_time": 0.40117406845092773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__account_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__account_history_tmp`\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    auto_tagging_enabled\n    \n as \n    \n    auto_tagging_enabled\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    descriptive_name\n    \n as \n    \n    descriptive_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    time_zone\n    \n as \n    \n    time_zone\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_active\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as account_id,\n        updated_at,\n        currency_code,\n        auto_tagging_enabled,\n        time_zone,\n        descriptive_name as account_name,\n        row_number() over (partition by source_relation, id order by updated_at desc) = 1 as is_most_recent_record\n    from fields\n    where coalesce(_fivetran_active, true)\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__account_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.944918Z", "completed_at": "2024-07-08T22:34:00.335147Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.336972Z", "completed_at": "2024-07-08T22:34:00.336975Z"}], "thread_id": "Thread-1", "execution_time": 0.4033987522125244, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_group_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_history_tmp`\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    campaign_name\n    \n as \n    \n    campaign_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_active\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(id as string) as ad_group_id,\n        updated_at,\n        type as ad_group_type, \n        campaign_id, \n        campaign_name, \n        name as ad_group_name, \n        status as ad_group_status,\n        row_number() over (partition by source_relation, id order by updated_at desc) = 1 as is_most_recent_record\n    from fields\n    where coalesce(_fivetran_active, true)\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:33:59.941362Z", "completed_at": "2024-07-08T22:34:00.335434Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.337252Z", "completed_at": "2024-07-08T22:34:00.337254Z"}], "thread_id": "Thread-4", "execution_time": 0.4044687747955322, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__account_stats", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__account_stats_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_network_type\n    \n as \n    \n    ad_network_type\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_micros\n    \n as \n    \n    cost_micros\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    conversions_value\n    \n as \n    \n    conversions_value\n    \n, \n    \n    \n    view_through_conversions\n    \n as \n    \n    view_through_conversions\n    \n, \n    \n    \n    view_through_conversions\n    \n as view_through_conversions_aliased \n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        customer_id as account_id, \n        date as date_day,\n        ad_network_type,\n        device,\n        coalesce(clicks, 0) as clicks, \n        coalesce(cost_micros, 0) / 1000000.0 as spend, \n        coalesce(impressions, 0) as impressions,\n        coalesce(conversions, 0) as conversions,\n        coalesce(conversions_value, 0) as conversions_value,\n        coalesce(view_through_conversions, 0) as view_through_conversions\n        \n        \n\n\n    \n        \n    \n        \n            \n                , coalesce(cast(view_through_conversions_aliased as FLOAT64), 0) as view_through_conversions_aliased\n            \n        \n    \n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__account_stats`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.285384Z", "completed_at": "2024-07-08T22:34:00.650097Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.651389Z", "completed_at": "2024-07-08T22:34:00.651400Z"}], "thread_id": "Thread-3", "execution_time": 0.36780309677124023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_group_stats", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_stats_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_network_type\n    \n as \n    \n    ad_network_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_micros\n    \n as \n    \n    cost_micros\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    conversions_value\n    \n as \n    \n    conversions_value\n    \n, \n    \n    \n    view_through_conversions\n    \n as \n    \n    view_through_conversions\n    \n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation,\n        customer_id as account_id, \n        date as date_day, \n        cast(id as string) as ad_group_id, \n        campaign_id, \n        device,\n        ad_network_type,\n        coalesce(clicks, 0) as clicks, \n        coalesce(cost_micros, 0) / 1000000.0 as spend, \n        coalesce(impressions, 0) as impressions,\n        coalesce(conversions, 0) as conversions,\n        coalesce(conversions_value, 0) as conversions_value,\n        coalesce(view_through_conversions, 0) as view_through_conversions\n        \n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_stats`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.338782Z", "completed_at": "2024-07-08T22:34:00.812265Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.813682Z", "completed_at": "2024-07-08T22:34:00.813688Z"}], "thread_id": "Thread-2", "execution_time": 0.4781620502471924, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    display_url\n    \n as \n    \n    display_url\n    \n, \n    \n    \n    final_urls\n    \n as \n    \n    final_urls\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_active\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(ad_group_id as string) as ad_group_id, \n        id as ad_id,\n        name as ad_name,\n        updated_at,\n        type as ad_type,\n        status as ad_status,\n        display_url,\n        final_urls as source_final_urls,\n        replace(replace(final_urls, '[', ''),']','') as final_urls,\n        row_number() over (partition by source_relation, id, ad_group_id order by updated_at desc) = 1 as is_most_recent_record\n    from fields\n    where coalesce(_fivetran_active, true)\n),\n\nfinal_urls as (\n\n    select \n        *,\n        --Extract the first url within the list of urls provided within the final_urls field\n        \n\n  \n    split(\n        final_urls,\n        ','\n        )[safe_offset(0)]\n  \n\n as final_url\n\n    from final\n\n),\n\nurl_fields as (\n    select \n        *,\n        \n\n  \n    split(\n        final_url,\n        '?'\n        )[safe_offset(0)]\n  \n\n as base_url,\n        \n    safe_cast(\n\n  \n    split(\n        \n\n  \n    split(\n        \n\n    replace(\n        \n\n    replace(\n        \n\n    replace(\n        final_url,\n        'android-app://',\n        ''\n    )\n\n\n,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/'\n        )[safe_offset(0)]\n  \n\n,\n        '?'\n        )[safe_offset(0)]\n  \n\n as string)\n as url_host,\n        '/' || \n    safe_cast(\n\n  \n    split(\n        \n\n    case when \n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/'\n\n    ), 0),\n            \n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '?'\n\n    ) - 1\n            ) = 0\n        then ''\n    else\n        substr(\n            \n\n    replace(\n        \n\n    replace(\n        final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n            -1 * (\n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/'\n\n    ), 0),\n            \n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '?'\n\n    ) - 1\n            ))\n        )\n    end,\n        '?'\n        )[safe_offset(0)]\n  \n\n as string)\n as url_path,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        final_url,\n        'utm_source='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_source,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        final_url,\n        'utm_medium='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_medium,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        final_url,\n        'utm_campaign='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_campaign,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        final_url,\n        'utm_content='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_content,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        final_url,\n        'utm_term='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_term\n    from final_urls\n)\n\nselect * \nfrom url_fields", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.394832Z", "completed_at": "2024-07-08T22:34:00.812606Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.814209Z", "completed_at": "2024-07-08T22:34:00.814212Z"}], "thread_id": "Thread-1", "execution_time": 0.4226837158203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__campaign_history_tmp`\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    advertising_channel_subtype\n    \n as \n    \n    advertising_channel_subtype\n    \n, \n    \n    \n    advertising_channel_type\n    \n as \n    \n    advertising_channel_type\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    end_date\n    \n as \n    \n    end_date\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    serving_status\n    \n as \n    \n    serving_status\n    \n, \n    \n    \n    start_date\n    \n as \n    \n    start_date\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    tracking_url_template\n    \n as \n    \n    tracking_url_template\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_active\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as campaign_id, \n        updated_at,\n        name as campaign_name,\n        customer_id as account_id,\n        advertising_channel_type,\n        advertising_channel_subtype,\n        start_date,\n        end_date,\n        serving_status,\n        status,\n        tracking_url_template,\n        row_number() over (partition by source_relation, id order by updated_at desc) = 1 as is_most_recent_record\n    from fields\n    where coalesce(_fivetran_active, true)\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__campaign_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.397812Z", "completed_at": "2024-07-08T22:34:00.813150Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.815052Z", "completed_at": "2024-07-08T22:34:00.815055Z"}], "thread_id": "Thread-4", "execution_time": 0.42288684844970703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_stats", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_stats_tmp`\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    ad_group\n    \n as \n    \n    ad_group\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    ad_network_type\n    \n as \n    \n    ad_network_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_micros\n    \n as \n    \n    cost_micros\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    keyword_ad_group_criterion\n    \n as \n    \n    keyword_ad_group_criterion\n    \n, \n    cast(null as INT64) as \n    \n    conversions\n    \n , \n    cast(null as INT64) as \n    \n    conversions_value\n    \n , \n    cast(null as INT64) as \n    \n    view_through_conversions\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        customer_id as account_id, \n        date as date_day, \n        \n        coalesce(cast(ad_group_id as string), \n\n  \n    split(\n        ad_group,\n        'adGroups/'\n        )[safe_offset(1)]\n  \n\n) as ad_group_id,\n        \n        keyword_ad_group_criterion,\n        ad_network_type,\n        device,\n        ad_id, \n        campaign_id, \n        coalesce(clicks, 0) as clicks, \n        coalesce(cost_micros, 0) / 1000000.0 as spend, \n        coalesce(impressions, 0) as impressions,\n        coalesce(conversions, 0) as conversions,\n        coalesce(conversions_value, 0) as conversions_value,\n        coalesce(view_through_conversions, 0) as view_through_conversions\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect * from final", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_stats`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.833747Z", "completed_at": "2024-07-08T22:34:00.839761Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.840302Z", "completed_at": "2024-07-08T22:34:00.840308Z"}], "thread_id": "Thread-4", "execution_time": 0.022161006927490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_group_criterion_history_criterion_id.7a0a8b8476", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect criterion_id\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_criterion_history`\nwhere criterion_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.823179Z", "completed_at": "2024-07-08T22:34:00.845640Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.846394Z", "completed_at": "2024-07-08T22:34:00.846398Z"}], "thread_id": "Thread-1", "execution_time": 0.028992891311645508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__ad_group_criterion_history_source_relation__criterion_id__ad_group_id__updated_at.8d37dd2fa0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, criterion_id, ad_group_id, updated_at\n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_criterion_history`\n    group by source_relation, criterion_id, ad_group_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.841980Z", "completed_at": "2024-07-08T22:34:00.847260Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.848521Z", "completed_at": "2024-07-08T22:34:00.848525Z"}], "thread_id": "Thread-4", "execution_time": 0.007875919342041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__account_history_source_relation__account_id__updated_at.0a4d931c44", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, updated_at\n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__account_history`\n    group by source_relation, account_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.849578Z", "completed_at": "2024-07-08T22:34:00.856586Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.857120Z", "completed_at": "2024-07-08T22:34:00.857125Z"}], "thread_id": "Thread-1", "execution_time": 0.00972890853881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__account_history_account_id.5ca373f51f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__account_history`\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.853542Z", "completed_at": "2024-07-08T22:34:00.857393Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.858664Z", "completed_at": "2024-07-08T22:34:00.858667Z"}], "thread_id": "Thread-4", "execution_time": 0.0066111087799072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__ad_group_history_source_relation__ad_group_id__updated_at.94eb3f93a4", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, updated_at\n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_history`\n    group by source_relation, ad_group_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.860324Z", "completed_at": "2024-07-08T22:34:00.868596Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.869117Z", "completed_at": "2024-07-08T22:34:00.869121Z"}], "thread_id": "Thread-1", "execution_time": 0.010932207107543945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_group_history_ad_group_id.f6c7c939be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_history`\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.864596Z", "completed_at": "2024-07-08T22:34:00.869375Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.870819Z", "completed_at": "2024-07-08T22:34:00.870823Z"}], "thread_id": "Thread-4", "execution_time": 0.007876157760620117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__account_stats_source_relation__account_id__device__ad_network_type__date_day.7d4d5e9ce2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, device, ad_network_type, date_day\n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__account_stats`\n    group by source_relation, account_id, device, ad_network_type, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.872636Z", "completed_at": "2024-07-08T22:34:00.879529Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.880056Z", "completed_at": "2024-07-08T22:34:00.880061Z"}], "thread_id": "Thread-1", "execution_time": 0.009438037872314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__account_stats_account_id.2a9da5417b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__account_stats`\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.876480Z", "completed_at": "2024-07-08T22:34:00.881135Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.882283Z", "completed_at": "2024-07-08T22:34:00.882286Z"}], "thread_id": "Thread-4", "execution_time": 0.009961843490600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__account_stats_date_day.57ac8772d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__account_stats`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.882546Z", "completed_at": "2024-07-08T22:34:00.890599Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.891135Z", "completed_at": "2024-07-08T22:34:00.891139Z"}], "thread_id": "Thread-1", "execution_time": 0.010188102722167969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__ad_group_stats_source_relation__ad_group_id__device__ad_network_type__date_day.0755df524f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, device, ad_network_type, date_day\n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_stats`\n    group by source_relation, ad_group_id, device, ad_network_type, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.886939Z", "completed_at": "2024-07-08T22:34:00.892178Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.893353Z", "completed_at": "2024-07-08T22:34:00.893356Z"}], "thread_id": "Thread-4", "execution_time": 0.01031184196472168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_group_stats_ad_group_id.a8d430f077", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_stats`\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.893623Z", "completed_at": "2024-07-08T22:34:00.901324Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.901880Z", "completed_at": "2024-07-08T22:34:00.901884Z"}], "thread_id": "Thread-1", "execution_time": 0.00986790657043457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_group_stats_date_day.3c6a221786", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_group_stats`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.897943Z", "completed_at": "2024-07-08T22:34:00.902661Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.903822Z", "completed_at": "2024-07-08T22:34:00.903825Z"}], "thread_id": "Thread-4", "execution_time": 0.007240772247314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__ad_history_source_relation__ad_id__ad_group_id__updated_at.edca86664e", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_id, ad_group_id, updated_at\n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_history`\n    group by source_relation, ad_id, ad_group_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.904846Z", "completed_at": "2024-07-08T22:34:00.912660Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.913189Z", "completed_at": "2024-07-08T22:34:00.913193Z"}], "thread_id": "Thread-1", "execution_time": 0.010486841201782227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_history_ad_id.8c23c38248", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_history`\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.908692Z", "completed_at": "2024-07-08T22:34:00.913437Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.914769Z", "completed_at": "2024-07-08T22:34:00.914771Z"}], "thread_id": "Thread-4", "execution_time": 0.0075702667236328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__campaign_history_source_relation__campaign_id__updated_at.008fea6b77", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, updated_at\n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__campaign_history`\n    group by source_relation, campaign_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.916481Z", "completed_at": "2024-07-08T22:34:00.923525Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.924731Z", "completed_at": "2024-07-08T22:34:00.924735Z"}], "thread_id": "Thread-1", "execution_time": 0.010439872741699219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__campaign_history_campaign_id.fa0c825e75", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__campaign_history`\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.920047Z", "completed_at": "2024-07-08T22:34:00.923939Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.925004Z", "completed_at": "2024-07-08T22:34:00.925007Z"}], "thread_id": "Thread-4", "execution_time": 0.006634950637817383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__ad_stats_source_relation__ad_id__ad_network_type__device__ad_group_id__keyword_ad_group_criterion__date_day.222a7d9413", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_id, ad_network_type, device, ad_group_id, keyword_ad_group_criterion, date_day\n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_stats`\n    group by source_relation, ad_id, ad_network_type, device, ad_group_id, keyword_ad_group_criterion, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.928120Z", "completed_at": "2024-07-08T22:34:00.934436Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.935503Z", "completed_at": "2024-07-08T22:34:00.935507Z"}], "thread_id": "Thread-1", "execution_time": 0.00935506820678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_stats_ad_id.2612d83cc8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_stats`\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.931056Z", "completed_at": "2024-07-08T22:34:00.934725Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.935765Z", "completed_at": "2024-07-08T22:34:00.935768Z"}], "thread_id": "Thread-4", "execution_time": 0.00952291488647461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_stats_date_day.9a43c0fce4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__ad_stats`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.654845Z", "completed_at": "2024-07-08T22:34:00.993471Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:00.994080Z", "completed_at": "2024-07-08T22:34:00.994087Z"}], "thread_id": "Thread-3", "execution_time": 0.34114503860473633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__campaign_stats", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__campaign_stats_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_network_type\n    \n as \n    \n    ad_network_type\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_micros\n    \n as \n    \n    cost_micros\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    conversions_value\n    \n as \n    \n    conversions_value\n    \n, \n    \n    \n    view_through_conversions\n    \n as \n    \n    view_through_conversions\n    \n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        customer_id as account_id, \n        date as date_day, \n        id as campaign_id, \n        ad_network_type,\n        device,\n        coalesce(clicks, 0) as clicks, \n        coalesce(cost_micros, 0) / 1000000.0 as spend, \n        coalesce(impressions, 0) as impressions,\n        coalesce(conversions, 0) as conversions,\n        coalesce(conversions_value, 0) as conversions_value,\n        coalesce(view_through_conversions, 0) as view_through_conversions\n        \n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__campaign_stats`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:01.002418Z", "completed_at": "2024-07-08T22:34:01.009310Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:01.010640Z", "completed_at": "2024-07-08T22:34:01.010647Z"}], "thread_id": "Thread-4", "execution_time": 0.015416145324707031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__campaign_stats_campaign_id.11587fa10f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__campaign_stats`\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.997785Z", "completed_at": "2024-07-08T22:34:01.009918Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:01.012340Z", "completed_at": "2024-07-08T22:34:01.012346Z"}], "thread_id": "Thread-1", "execution_time": 0.017641067504882812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__campaign_stats_source_relation__campaign_id__ad_network_type__device__date_day.fea3ecfe6f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, ad_network_type, device, date_day\n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__campaign_stats`\n    group by source_relation, campaign_id, ad_network_type, device, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:01.005536Z", "completed_at": "2024-07-08T22:34:01.010354Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:01.012730Z", "completed_at": "2024-07-08T22:34:01.012736Z"}], "thread_id": "Thread-3", "execution_time": 0.016896963119506836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__campaign_stats_date_day.dc097fd76b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__campaign_stats`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:00.819250Z", "completed_at": "2024-07-08T22:34:01.264862Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:01.265759Z", "completed_at": "2024-07-08T22:34:01.265771Z"}], "thread_id": "Thread-2", "execution_time": 0.44940900802612305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__keyword_stats", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__keyword_stats_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_group_criterion_criterion_id\n    \n as \n    \n    ad_group_criterion_criterion_id\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_network_type\n    \n as \n    \n    ad_network_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_micros\n    \n as \n    \n    cost_micros\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    conversions_value\n    \n as \n    \n    conversions_value\n    \n, \n    \n    \n    view_through_conversions\n    \n as \n    \n    view_through_conversions\n    \n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        _fivetran_id as keyword_id,\n        customer_id as account_id, \n        date as date_day, \n        cast(ad_group_id as string) as ad_group_id,\n        ad_group_criterion_criterion_id as criterion_id,\n        campaign_id, \n        coalesce(clicks, 0) as clicks, \n        coalesce(cost_micros, 0) / 1000000.0 as spend, \n        coalesce(impressions, 0) as impressions,\n        coalesce(conversions, 0) as conversions,\n        coalesce(conversions_value, 0) as conversions_value,\n        coalesce(view_through_conversions, 0) as view_through_conversions\n        \n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__keyword_stats`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:01.270348Z", "completed_at": "2024-07-08T22:34:01.287102Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:01.287950Z", "completed_at": "2024-07-08T22:34:01.287956Z"}], "thread_id": "Thread-4", "execution_time": 0.02074599266052246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__keyword_stats_source_relation__keyword_id__date_day.4ecf84a32f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, keyword_id, date_day\n    from `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__keyword_stats`\n    group by source_relation, keyword_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:01.277254Z", "completed_at": "2024-07-08T22:34:01.289178Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:01.290163Z", "completed_at": "2024-07-08T22:34:01.290167Z"}], "thread_id": "Thread-1", "execution_time": 0.021558046340942383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__keyword_stats_date_day.a9da72f74d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__keyword_stats`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-08T22:34:01.282861Z", "completed_at": "2024-07-08T22:34:01.289809Z"}, {"name": "execute", "started_at": "2024-07-08T22:34:01.291445Z", "completed_at": "2024-07-08T22:34:01.291449Z"}], "thread_id": "Thread-3", "execution_time": 0.01627516746520996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__keyword_stats_keyword_id.f0945d6cf0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom `dbt-package-testing`.`google_ads_source_integration_tests_3_google_ads_source`.`stg_google_ads__keyword_stats`\nwhere keyword_id is null\n\n\n", "relation_name": null}], "elapsed_time": 2.5423648357391357, "args": {"static": false, "log_format_file": "debug", "strict_mode": false, "invocation_command": "dbt docs generate", "empty_catalog": false, "partial_parse": true, "print": true, "use_colors": true, "quiet": false, "select": [], "profiles_dir": "/Users/jamie.rodriguez/.dbt", "log_file_max_bytes": 10485760, "enable_legacy_logger": false, "macro_debugging": false, "send_anonymous_usage_stats": true, "cache_selected_only": false, "log_level_file": "debug", "introspect": true, "printer_width": 80, "log_format": "default", "defer": false, "project_dir": "/Users/jamie.rodriguez/Desktop/dbt_repos/Ads/dev/dbt_packages/google_ads_source/integration_tests", "favor_state": false, "partial_parse_file_diff": true, "log_path": "/Users/jamie.rodriguez/Desktop/dbt_repos/Ads/dev/dbt_packages/google_ads_source/integration_tests/logs", "show_resource_report": false, "compile": true, "populate_cache": true, "vars": {}, "version_check": true, "static_parser": true, "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "exclude": [], "log_level": "info", "write_json": true, "indirect_selection": "eager", "which": "generate"}}