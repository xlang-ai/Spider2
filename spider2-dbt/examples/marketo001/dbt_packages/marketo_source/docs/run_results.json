{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.8", "generated_at": "2024-02-29T15:28:15.901659Z", "invocation_id": "9b425e78-4d62-4b80-9b3f-a4c4a37e5435", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.492949Z", "completed_at": "2024-02-29T15:28:13.502956Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.505177Z", "completed_at": "2024-02-29T15:28:13.505198Z"}], "thread_id": "Thread-3", "execution_time": 0.027894973754882812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_delete_lead_tmp", "compiled": true, "compiled_code": "\n\nselect *\nfrom `dbt-package-testing`.`marketo_source`.`marketo_activity_delete_lead_data`", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_delete_lead_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.480523Z", "completed_at": "2024-02-29T15:28:13.503317Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.505473Z", "completed_at": "2024-02-29T15:28:13.505477Z"}], "thread_id": "Thread-1", "execution_time": 0.030936717987060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_change_data_value_tmp", "compiled": true, "compiled_code": "select *\nfrom `dbt-package-testing`.`marketo_source`.`marketo_activity_change_data_value_data`", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_change_data_value_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.499928Z", "completed_at": "2024-02-29T15:28:13.503599Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.505747Z", "completed_at": "2024-02-29T15:28:13.505751Z"}], "thread_id": "Thread-4", "execution_time": 0.02820301055908203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_email_bounced_tmp", "compiled": true, "compiled_code": "select *\nfrom `dbt-package-testing`.`marketo_source`.`marketo_activity_email_bounced_data`", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_email_bounced_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.488111Z", "completed_at": "2024-02-29T15:28:13.503861Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.506042Z", "completed_at": "2024-02-29T15:28:13.506046Z"}], "thread_id": "Thread-2", "execution_time": 0.030547142028808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_click_email_tmp", "compiled": true, "compiled_code": "select *\nfrom `dbt-package-testing`.`marketo_source`.`marketo_activity_click_email_data`", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_click_email_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.513278Z", "completed_at": "2024-02-29T15:28:13.524712Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.525268Z", "completed_at": "2024-02-29T15:28:13.525276Z"}], "thread_id": "Thread-3", "execution_time": 0.015470743179321289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_email_delivered_tmp", "compiled": true, "compiled_code": "select *\nfrom `dbt-package-testing`.`marketo_source`.`marketo_activity_email_delivered_data`", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_email_delivered_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.516039Z", "completed_at": "2024-02-29T15:28:13.529507Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.531399Z", "completed_at": "2024-02-29T15:28:13.531406Z"}], "thread_id": "Thread-1", "execution_time": 0.02174091339111328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_merge_leads_tmp", "compiled": true, "compiled_code": "select *\nfrom `dbt-package-testing`.`marketo_source`.`marketo_activity_merge_leads_data`", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_merge_leads_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.521267Z", "completed_at": "2024-02-29T15:28:13.529792Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.531673Z", "completed_at": "2024-02-29T15:28:13.531677Z"}], "thread_id": "Thread-2", "execution_time": 0.021174907684326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_send_email_tmp", "compiled": true, "compiled_code": "select *\nfrom `dbt-package-testing`.`marketo_source`.`marketo_activity_send_email_data`", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_send_email_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.518755Z", "completed_at": "2024-02-29T15:28:13.530122Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.531947Z", "completed_at": "2024-02-29T15:28:13.531950Z"}], "thread_id": "Thread-4", "execution_time": 0.022301912307739258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_open_email_tmp", "compiled": true, "compiled_code": "select *\nfrom `dbt-package-testing`.`marketo_source`.`marketo_activity_open_email_data`", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_open_email_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.526998Z", "completed_at": "2024-02-29T15:28:13.531147Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.533995Z", "completed_at": "2024-02-29T15:28:13.533998Z"}], "thread_id": "Thread-3", "execution_time": 0.008934259414672852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_unsubscribe_email_tmp", "compiled": true, "compiled_code": "select *\nfrom `dbt-package-testing`.`marketo_source`.`marketo_activity_unsubscribe_email_data`", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_unsubscribe_email_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.545833Z", "completed_at": "2024-02-29T15:28:13.547672Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.548193Z", "completed_at": "2024-02-29T15:28:13.548198Z"}], "thread_id": "Thread-3", "execution_time": 0.01085805892944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_activity_change_data_value_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.549833Z", "completed_at": "2024-02-29T15:28:13.550947Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.551426Z", "completed_at": "2024-02-29T15:28:13.551429Z"}], "thread_id": "Thread-3", "execution_time": 0.0026357173919677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_activity_click_email_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.552972Z", "completed_at": "2024-02-29T15:28:13.554115Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.554585Z", "completed_at": "2024-02-29T15:28:13.554589Z"}], "thread_id": "Thread-3", "execution_time": 0.00261688232421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_activity_delete_lead_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.556128Z", "completed_at": "2024-02-29T15:28:13.557217Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.557788Z", "completed_at": "2024-02-29T15:28:13.557792Z"}], "thread_id": "Thread-3", "execution_time": 0.002707958221435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_activity_email_bounced_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.559435Z", "completed_at": "2024-02-29T15:28:13.560606Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.562344Z", "completed_at": "2024-02-29T15:28:13.562348Z"}], "thread_id": "Thread-3", "execution_time": 0.0046520233154296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_activity_email_delivered_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.543163Z", "completed_at": "2024-02-29T15:28:13.560892Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.562600Z", "completed_at": "2024-02-29T15:28:13.562604Z"}], "thread_id": "Thread-4", "execution_time": 0.027584075927734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__lead_tmp", "compiled": true, "compiled_code": "select *\nfrom `dbt-package-testing`.`marketo_source`.`marketo_lead_data`", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__lead_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.540814Z", "completed_at": "2024-02-29T15:28:13.561151Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.563078Z", "completed_at": "2024-02-29T15:28:13.563081Z"}], "thread_id": "Thread-2", "execution_time": 0.02872180938720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__lead_describe_tmp", "compiled": true, "compiled_code": "select *\nfrom `dbt-package-testing`.`marketo_source`.`marketo_lead_describe_data`", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__lead_describe_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.538194Z", "completed_at": "2024-02-29T15:28:13.561877Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.564333Z", "completed_at": "2024-02-29T15:28:13.564336Z"}], "thread_id": "Thread-1", "execution_time": 0.030192852020263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__email_template_history_tmp", "compiled": true, "compiled_code": "select *\nfrom `dbt-package-testing`.`marketo_source`.`marketo_email_template_history_data`", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__email_template_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.569004Z", "completed_at": "2024-02-29T15:28:13.570892Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.576244Z", "completed_at": "2024-02-29T15:28:13.576248Z"}], "thread_id": "Thread-3", "execution_time": 0.010923147201538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_activity_merge_leads_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.571196Z", "completed_at": "2024-02-29T15:28:13.572309Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.576491Z", "completed_at": "2024-02-29T15:28:13.576494Z"}], "thread_id": "Thread-4", "execution_time": 0.011003971099853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_activity_open_email_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.572838Z", "completed_at": "2024-02-29T15:28:13.573941Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.576941Z", "completed_at": "2024-02-29T15:28:13.576944Z"}], "thread_id": "Thread-2", "execution_time": 0.011039972305297852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_activity_send_email_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.574691Z", "completed_at": "2024-02-29T15:28:13.575768Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.578142Z", "completed_at": "2024-02-29T15:28:13.578145Z"}], "thread_id": "Thread-1", "execution_time": 0.011136054992675781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_activity_unsubscribe_email_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.582412Z", "completed_at": "2024-02-29T15:28:13.583584Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.589542Z", "completed_at": "2024-02-29T15:28:13.589547Z"}], "thread_id": "Thread-3", "execution_time": 0.010636091232299805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_campaign_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.583844Z", "completed_at": "2024-02-29T15:28:13.584921Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.589787Z", "completed_at": "2024-02-29T15:28:13.589790Z"}], "thread_id": "Thread-4", "execution_time": 0.010746240615844727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_email_template_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.586108Z", "completed_at": "2024-02-29T15:28:13.587169Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.590278Z", "completed_at": "2024-02-29T15:28:13.590282Z"}], "thread_id": "Thread-2", "execution_time": 0.010934114456176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_lead_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.587922Z", "completed_at": "2024-02-29T15:28:13.589039Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.591550Z", "completed_at": "2024-02-29T15:28:13.591553Z"}], "thread_id": "Thread-1", "execution_time": 0.01119685173034668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_lead_describe_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.595981Z", "completed_at": "2024-02-29T15:28:13.597220Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:13.653396Z", "completed_at": "2024-02-29T15:28:13.653404Z"}], "thread_id": "Thread-3", "execution_time": 0.061158180236816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.marketo_source_integration_tests.marketo_program_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.597507Z", "completed_at": "2024-02-29T15:28:14.303775Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:14.305931Z", "completed_at": "2024-02-29T15:28:14.305939Z"}], "thread_id": "Thread-4", "execution_time": 0.7132842540740967, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_delete_lead", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_delete_lead_tmp`\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    activity_date\n    \n as \n    \n    activity_date\n    \n, \n    \n    \n    activity_type_id\n    \n as \n    \n    activity_type_id\n    \n, \n    \n    \n    campaign\n    \n as \n    \n    campaign\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    lead_id\n    \n as \n    \n    lead_id\n    \n, \n    \n    \n    primary_attribute_value\n    \n as \n    \n    primary_attribute_value\n    \n, \n    \n    \n    primary_attribute_value_id\n    \n as \n    \n    primary_attribute_value_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        id as activity_id,\n        _fivetran_synced,\n        cast(activity_date as timestamp) as activity_timestamp,\n        activity_type_id,\n        campaign as campaign_name,\n        campaign_id,\n        lead_id,\n        primary_attribute_value,\n        primary_attribute_value_id\n    from macro\n\n)\n\nselect *\nfrom fields", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_delete_lead`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.655952Z", "completed_at": "2024-02-29T15:28:14.304086Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:14.306218Z", "completed_at": "2024-02-29T15:28:14.306222Z"}], "thread_id": "Thread-3", "execution_time": 0.6524388790130615, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_click_email", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_click_email_tmp`\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    activity_date\n    \n as \n    \n    activity_date\n    \n, \n    \n    \n    activity_type_id\n    \n as \n    \n    activity_type_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    campaign_run_id\n    \n as \n    \n    campaign_run_id\n    \n, \n    \n    \n    choice_number\n    \n as \n    \n    choice_number\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    email_template_id\n    \n as \n    \n    email_template_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    is_mobile_device\n    \n as \n    \n    is_mobile_device\n    \n, \n    \n    \n    lead_id\n    \n as \n    \n    lead_id\n    \n, \n    \n    \n    link\n    \n as \n    \n    link\n    \n, \n    cast(null as string) as \n    \n    link_id\n    \n , \n    \n    \n    platform\n    \n as \n    \n    platform\n    \n, \n    \n    \n    primary_attribute_value\n    \n as \n    \n    primary_attribute_value\n    \n, \n    \n    \n    primary_attribute_value_id\n    \n as \n    \n    primary_attribute_value_id\n    \n, \n    \n    \n    step_id\n    \n as \n    \n    step_id\n    \n, \n    cast(null as INT64) as \n    \n    test_variant\n    \n , \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select \n        cast(activity_date as timestamp) as activity_timestamp,\n        activity_type_id,\n        campaign_id,\n        campaign_run_id,\n        choice_number,\n        device as click_device,\n        email_template_id,\n        id as activity_id,\n        is_mobile_device,\n        lead_id,\n        link as click_link_url,\n        platform as user_platform,\n        primary_attribute_value,\n        primary_attribute_value_id,\n        step_id,\n        user_agent\n    from macro\n\n), surrogate as (\n\n    select \n        *,\n        to_hex(md5(cast(coalesce(cast(primary_attribute_value_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(campaign_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(campaign_run_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lead_id as string), '_dbt_utils_surrogate_key_null_') as string))) as email_send_id\n    from fields\n\n)\n\nselect *\nfrom surrogate", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_click_email`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.600598Z", "completed_at": "2024-02-29T15:28:14.304397Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:14.306490Z", "completed_at": "2024-02-29T15:28:14.306493Z"}], "thread_id": "Thread-2", "execution_time": 0.7137241363525391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_change_data_value", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_change_data_value_tmp`\n\n), macro as (\n\n    select \n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    activity_date\n    \n as \n    \n    activity_date\n    \n, \n    \n    \n    activity_type_id\n    \n as \n    \n    activity_type_id\n    \n, \n    \n    \n    api_method_name\n    \n as \n    \n    api_method_name\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    lead_id\n    \n as \n    \n    lead_id\n    \n, \n    \n    \n    modifying_user\n    \n as \n    \n    modifying_user\n    \n, \n    \n    \n    new_value\n    \n as \n    \n    new_value\n    \n, \n    \n    \n    old_value\n    \n as \n    \n    old_value\n    \n, \n    \n    \n    primary_attribute_value\n    \n as \n    \n    primary_attribute_value\n    \n, \n    \n    \n    primary_attribute_value_id\n    \n as \n    \n    primary_attribute_value_id\n    \n, \n    \n    \n    reason\n    \n as \n    \n    reason\n    \n, \n    \n    \n    request_id\n    \n as \n    \n    request_id\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n\n\n\n    from base\n\n), fields as (\n\n    select \n        cast(activity_date as timestamp) as activity_timestamp,\n        activity_type_id,\n        api_method_name,\n        campaign_id,\n        id as activity_id,\n        lead_id,\n        modifying_user as modifying_user_id,\n        new_value,\n        old_value,\n        primary_attribute_value,\n        primary_attribute_value_id,\n        reason as change_reason,\n        request_id,\n        source as change_source\n    from macro\n\n)\n\nselect *\nfrom fields", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_change_data_value`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:13.603814Z", "completed_at": "2024-02-29T15:28:14.304667Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:14.306753Z", "completed_at": "2024-02-29T15:28:14.306756Z"}], "thread_id": "Thread-1", "execution_time": 0.7133548259735107, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_email_bounced", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_email_bounced_tmp`\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    activity_date\n    \n as \n    \n    activity_date\n    \n, \n    \n    \n    activity_type_id\n    \n as \n    \n    activity_type_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    campaign_run_id\n    \n as \n    \n    campaign_run_id\n    \n, \n    \n    \n    category\n    \n as \n    \n    category\n    \n, \n    \n    \n    choice_number\n    \n as \n    \n    choice_number\n    \n, \n    \n    \n    details\n    \n as \n    \n    details\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    email_template_id\n    \n as \n    \n    email_template_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    lead_id\n    \n as \n    \n    lead_id\n    \n, \n    \n    \n    primary_attribute_value\n    \n as \n    \n    primary_attribute_value\n    \n, \n    \n    \n    primary_attribute_value_id\n    \n as \n    \n    primary_attribute_value_id\n    \n, \n    \n    \n    step_id\n    \n as \n    \n    step_id\n    \n, \n    \n    \n    subcategory\n    \n as \n    \n    subcategory\n    \n, \n    cast(null as INT64) as \n    \n    test_variant\n    \n \n\n\n    from base\n\n), fields as (\n\n    select \t\n        cast(activity_date as timestamp) as activity_timestamp,\n        activity_type_id,\n        campaign_id,\n        campaign_run_id,\n        category as bounce_category,\n        choice_number,\n        details,\n        email as email_address,\n        email_template_id,\n        id as activity_id,\n        lead_id,\n        primary_attribute_value,\n        primary_attribute_value_id,\n        step_id,\n        subcategory as bounce_subcategory\n    from macro\n\n), surrogate as (\n\n    select \n        *,\n        to_hex(md5(cast(coalesce(cast(primary_attribute_value_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(campaign_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(campaign_run_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lead_id as string), '_dbt_utils_surrogate_key_null_') as string))) as email_send_id\n    from fields\n\n)\n\nselect *\nfrom surrogate", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_email_bounced`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:14.315906Z", "completed_at": "2024-02-29T15:28:14.907100Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:14.908636Z", "completed_at": "2024-02-29T15:28:14.908643Z"}], "thread_id": "Thread-3", "execution_time": 0.5990598201751709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_merge_leads", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_merge_leads_tmp`\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    activity_date\n    \n as \n    \n    activity_date\n    \n, \n    \n    \n    activity_type_id\n    \n as \n    \n    activity_type_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    lead_id\n    \n as \n    \n    lead_id\n    \n, \n    \n    \n    master_updated\n    \n as \n    \n    master_updated\n    \n, \n    \n    \n    merge_ids\n    \n as \n    \n    merge_ids\n    \n, \n    \n    \n    merge_source\n    \n as \n    \n    merge_source\n    \n, \n    \n    \n    merged_in_sales\n    \n as \n    \n    merged_in_sales\n    \n, \n    \n    \n    primary_attribute_value\n    \n as \n    \n    primary_attribute_value\n    \n, \n    \n    \n    primary_attribute_value_id\n    \n as \n    \n    primary_attribute_value_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        id as activity_id,\n        _fivetran_synced,\n        cast(activity_date as timestamp) as activity_timestamp,\n        activity_type_id,\n        campaign_id,\n        cast(lead_id as INT64) as lead_id,\n        master_updated,\n        cast(replace(trim(trim(merge_ids,']'),'['), ',', ', ') as string) as merged_lead_id,\n        merge_source,\n        merged_in_sales,\n        primary_attribute_value,\n        primary_attribute_value_id\n    from macro\n\n)\n\nselect *\nfrom fields", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_merge_leads`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:14.321496Z", "completed_at": "2024-02-29T15:28:14.907469Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:14.909205Z", "completed_at": "2024-02-29T15:28:14.909209Z"}], "thread_id": "Thread-1", "execution_time": 0.599233865737915, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_open_email", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_open_email_tmp`\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    activity_date\n    \n as \n    \n    activity_date\n    \n, \n    \n    \n    activity_type_id\n    \n as \n    \n    activity_type_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    campaign_run_id\n    \n as \n    \n    campaign_run_id\n    \n, \n    \n    \n    choice_number\n    \n as \n    \n    choice_number\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    email_template_id\n    \n as \n    \n    email_template_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    is_mobile_device\n    \n as \n    \n    is_mobile_device\n    \n, \n    \n    \n    lead_id\n    \n as \n    \n    lead_id\n    \n, \n    \n    \n    platform\n    \n as \n    \n    platform\n    \n, \n    \n    \n    primary_attribute_value\n    \n as \n    \n    primary_attribute_value\n    \n, \n    \n    \n    primary_attribute_value_id\n    \n as \n    \n    primary_attribute_value_id\n    \n, \n    \n    \n    step_id\n    \n as \n    \n    step_id\n    \n, \n    cast(null as INT64) as \n    \n    test_variant\n    \n , \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select \n        cast(activity_date as timestamp) as activity_timestamp,\n        activity_type_id,\n        campaign_id,\n        campaign_run_id,\n        choice_number,\n        device,\n        email_template_id,\n        id as activity_id,\n        is_mobile_device,\n        lead_id,\n        platform,\n        primary_attribute_value,\n        primary_attribute_value_id,\n        step_id,\n        user_agent\n    from macro\n\n), surrogate as (\n\n    select \n        *,\n        to_hex(md5(cast(coalesce(cast(primary_attribute_value_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(campaign_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(campaign_run_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lead_id as string), '_dbt_utils_surrogate_key_null_') as string))) as email_send_id\n    from fields\n\n)\n\nselect *\nfrom surrogate", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_open_email`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:14.318648Z", "completed_at": "2024-02-29T15:28:14.908071Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:14.910123Z", "completed_at": "2024-02-29T15:28:14.910126Z"}], "thread_id": "Thread-2", "execution_time": 0.6004509925842285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_send_email", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_send_email_tmp`\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    activity_date\n    \n as \n    \n    activity_date\n    \n, \n    \n    \n    activity_type_id\n    \n as \n    \n    activity_type_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    campaign_run_id\n    \n as \n    \n    campaign_run_id\n    \n, \n    \n    \n    choice_number\n    \n as \n    \n    choice_number\n    \n, \n    \n    \n    email_template_id\n    \n as \n    \n    email_template_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    lead_id\n    \n as \n    \n    lead_id\n    \n, \n    \n    \n    primary_attribute_value\n    \n as \n    \n    primary_attribute_value\n    \n, \n    \n    \n    primary_attribute_value_id\n    \n as \n    \n    primary_attribute_value_id\n    \n, \n    \n    \n    step_id\n    \n as \n    \n    step_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select \n        cast(activity_date as timestamp) as activity_timestamp,\n        activity_type_id,\n        campaign_id,\n        campaign_run_id,\n        choice_number,\n        email_template_id,\n        id as activity_id,\n        lead_id,\n        primary_attribute_value,\n        primary_attribute_value_id,\n        step_id\n\n        \n\n\n\n\n\n    from macro\n\n), surrogate as (\n\n    select \n        *,\n        to_hex(md5(cast(coalesce(cast(primary_attribute_value_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(campaign_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(campaign_run_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lead_id as string), '_dbt_utils_surrogate_key_null_') as string))) as email_send_id\n    from fields\n\n)\n\nselect *\nfrom surrogate", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_send_email`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:14.312594Z", "completed_at": "2024-02-29T15:28:14.993728Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:14.994448Z", "completed_at": "2024-02-29T15:28:14.994456Z"}], "thread_id": "Thread-4", "execution_time": 0.684736967086792, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_email_delivered", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_email_delivered_tmp`\n\n), macro as (\n\n    select \n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    activity_date\n    \n as \n    \n    activity_date\n    \n, \n    \n    \n    activity_type_id\n    \n as \n    \n    activity_type_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    campaign_run_id\n    \n as \n    \n    campaign_run_id\n    \n, \n    \n    \n    choice_number\n    \n as \n    \n    choice_number\n    \n, \n    \n    \n    email_template_id\n    \n as \n    \n    email_template_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    lead_id\n    \n as \n    \n    lead_id\n    \n, \n    \n    \n    primary_attribute_value\n    \n as \n    \n    primary_attribute_value\n    \n, \n    \n    \n    primary_attribute_value_id\n    \n as \n    \n    primary_attribute_value_id\n    \n, \n    \n    \n    step_id\n    \n as \n    \n    step_id\n    \n, \n    cast(null as INT64) as \n    \n    test_variant\n    \n \n\n\n    from base\n\n), fields as (\n\n    select \n        cast(activity_date as timestamp) as activity_timestamp,\n        activity_type_id,\n        campaign_id,\n        campaign_run_id,\n        choice_number,\n        email_template_id,\n        id as activity_id, \n        lead_id,\n        primary_attribute_value,\n        primary_attribute_value_id,\n        step_id\n    from macro\n\n), surrogate as (\n\n    select \n        *,\n        to_hex(md5(cast(coalesce(cast(primary_attribute_value_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(campaign_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(campaign_run_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lead_id as string), '_dbt_utils_surrogate_key_null_') as string))) as email_send_id\n    from fields\n\n)\n\nselect *\nfrom surrogate", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_email_delivered`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:14.914545Z", "completed_at": "2024-02-29T15:28:15.497556Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.498859Z", "completed_at": "2024-02-29T15:28:15.498866Z"}], "thread_id": "Thread-3", "execution_time": 0.5876584053039551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__activity_unsubscribe_email", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_unsubscribe_email_tmp`\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    activity_date\n    \n as \n    \n    activity_date\n    \n, \n    \n    \n    activity_type_id\n    \n as \n    \n    activity_type_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    campaign_run_id\n    \n as \n    \n    campaign_run_id\n    \n, \n    \n    \n    client_ip_address\n    \n as \n    \n    client_ip_address\n    \n, \n    \n    \n    email_template_id\n    \n as \n    \n    email_template_id\n    \n, \n    \n    \n    form_fields\n    \n as \n    \n    form_fields\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    lead_id\n    \n as \n    \n    lead_id\n    \n, \n    \n    \n    primary_attribute_value\n    \n as \n    \n    primary_attribute_value\n    \n, \n    \n    \n    primary_attribute_value_id\n    \n as \n    \n    primary_attribute_value_id\n    \n, \n    \n    \n    query_parameters\n    \n as \n    \n    query_parameters\n    \n, \n    \n    \n    referrer_url\n    \n as \n    \n    referrer_url\n    \n, \n    cast(null as INT64) as \n    \n    test_variant\n    \n , \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n, \n    \n    \n    webform_id\n    \n as \n    \n    webform_id\n    \n, \n    \n    \n    webpage_id\n    \n as \n    \n    webpage_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select \t\n        cast(activity_date as timestamp) as activity_timestamp,\n        activity_type_id,\n        campaign_id,\n        campaign_run_id,\n        client_ip_address,\n        email_template_id,\n        form_fields,\n        id as activity_id,\n        lead_id,\n        primary_attribute_value,\n        primary_attribute_value_id,\n        query_parameters,\n        referrer_url,\n        user_agent,\n        webform_id,\n        webpage_id\n    from macro\n\n), surrogate as (\n\n    select \n        *,\n        to_hex(md5(cast(coalesce(cast(primary_attribute_value_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(campaign_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(campaign_run_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lead_id as string), '_dbt_utils_surrogate_key_null_') as string))) as email_send_id\n    from fields\n\n)\n\nselect *\nfrom surrogate", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_unsubscribe_email`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:14.920091Z", "completed_at": "2024-02-29T15:28:15.497919Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.499266Z", "completed_at": "2024-02-29T15:28:15.499269Z"}], "thread_id": "Thread-2", "execution_time": 0.5866570472717285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__lead_describe", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__lead_describe_tmp`\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    data_type\n    \n as \n    \n    data_type\n    \n, \n    \n    \n    display_name\n    \n as \n    \n    display_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    length\n    \n as \n    \n    length\n    \n, \n    \n    \n    restname\n    \n as \n    \n    restname\n    \n, \n    \n    \n    restread_only\n    \n as \n    \n    restread_only\n    \n, \n    \n    \n    soapname\n    \n as \n    \n    soapname\n    \n, \n    \n    \n    soapread_only\n    \n as \n    \n    soapread_only\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        data_type,\n        display_name,\n        id as lead_describe_id,\n        length as field_max_length,\n        restname as rest_name,\n        restread_only as is_rest_readonly,\n        soapname as soap_name,\n        soapread_only as is_soap_readonly\n    from macro\n\n), regex as (\n\n    select \n        *,\n        case\n            when rest_name like '%\\\\_\\\\_c%' then lower(rest_name)\n            else ltrim(lower(regexp_replace(rest_name, '[A-Z]','_\\\\0')),'_')\n        end as rest_name_xf\n    from fields\n\n)\n\nselect *\nfrom regex", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__lead_describe`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.522941Z", "completed_at": "2024-02-29T15:28:15.527893Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.528470Z", "completed_at": "2024-02-29T15:28:15.528477Z"}], "thread_id": "Thread-2", "execution_time": 0.026947975158691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.unique_stg_marketo__activity_click_email_activity_id.6c599791a0", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select activity_id as unique_field\n  from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_click_email`\n  where activity_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.502824Z", "completed_at": "2024-02-29T15:28:15.533262Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.534435Z", "completed_at": "2024-02-29T15:28:15.534441Z"}], "thread_id": "Thread-3", "execution_time": 0.0336461067199707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.not_null_stg_marketo__activity_click_email_activity_id.8e4b4af9fd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_click_email`\nwhere activity_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:14.996528Z", "completed_at": "2024-02-29T15:28:15.533545Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.534721Z", "completed_at": "2024-02-29T15:28:15.534724Z"}], "thread_id": "Thread-4", "execution_time": 0.539909839630127, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__email_template_history", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__email_template_history_tmp`\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    folder_folder_name\n    \n as \n    \n    folder_folder_name\n    \n, \n    \n    \n    folder_id\n    \n as \n    \n    folder_id\n    \n, \n    \n    \n    folder_type\n    \n as \n    \n    folder_type\n    \n, \n    \n    \n    folder_value\n    \n as \n    \n    folder_value\n    \n, \n    \n    \n    from_email\n    \n as \n    \n    from_email\n    \n, \n    \n    \n    from_name\n    \n as \n    \n    from_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    operational\n    \n as \n    \n    operational\n    \n, \n    \n    \n    program_id\n    \n as \n    \n    program_id\n    \n, \n    \n    \n    publish_to_msi\n    \n as \n    \n    publish_to_msi\n    \n, \n    \n    \n    reply_email\n    \n as \n    \n    reply_email\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n    template\n    \n as \n    \n    template\n    \n, \n    \n    \n    text_only\n    \n as \n    \n    text_only\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    \n    \n    url\n    \n as \n    \n    url\n    \n, \n    \n    \n    version\n    \n as \n    \n    version\n    \n, \n    \n    \n    web_view\n    \n as \n    \n    web_view\n    \n, \n    \n    \n    workspace\n    \n as \n    \n    workspace\n    \n\n\n\n    from base\n\n), fields as (\n\n    select \n        created_at as created_timestamp,\n        description,\n        folder_folder_name as folder_name,\n        folder_id,\n        folder_type,\n        folder_value,\n        from_email,\n        from_name,\n        id as email_template_id,\n        name as email_template_name,\n        operational as is_operational,\n        program_id,\n        publish_to_msi,\n        reply_email,\n        status as email_template_status,\n        subject as email_subject,\n        template as parent_template_id,\n        text_only as is_text_only,\n        updated_at as updated_timestamp,\n        url as email_template_url,\n        version as version_type,\n        web_view as has_web_view_enabled,\n        workspace as workspace_name\n    from macro\n\n), versions as (\n\n    select  \n        *,\n        row_number() over (partition by email_template_id order by updated_timestamp) as inferred_version,\n        count(*) over (partition by email_template_id) as total_count_of_versions\n    from fields\n\n), valid as (\n\n    select \n        *, \n        case\n            when inferred_version = 1 then created_timestamp\n            else updated_timestamp\n        end as valid_from,\n        lead(updated_timestamp) over (partition by email_template_id order by updated_timestamp) as valid_to,\n        inferred_version = total_count_of_versions as is_most_recent_version\n    from versions\n\n), surrogate_key as (\n\n    select \n        *,\n        to_hex(md5(cast(coalesce(cast(email_template_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(inferred_version as string), '_dbt_utils_surrogate_key_null_') as string))) as email_template_history_id\n    from valid\n\n)\n\nselect *\nfrom surrogate_key", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__email_template_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.530114Z", "completed_at": "2024-02-29T15:28:15.536032Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.537868Z", "completed_at": "2024-02-29T15:28:15.537871Z"}], "thread_id": "Thread-2", "execution_time": 0.009217977523803711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.not_null_stg_marketo__activity_change_data_value_activity_id.8ae060d108", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_change_data_value`\nwhere activity_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.539041Z", "completed_at": "2024-02-29T15:28:15.548923Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.549407Z", "completed_at": "2024-02-29T15:28:15.549411Z"}], "thread_id": "Thread-3", "execution_time": 0.012738943099975586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.not_null_stg_marketo__activity_email_bounced_activity_id.578b8cddf2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_email_bounced`\nwhere activity_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.542170Z", "completed_at": "2024-02-29T15:28:15.554368Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.554894Z", "completed_at": "2024-02-29T15:28:15.554899Z"}], "thread_id": "Thread-4", "execution_time": 0.018132925033569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.unique_stg_marketo__activity_change_data_value_activity_id.7c7047bbcd", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select activity_id as unique_field\n  from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_change_data_value`\n  where activity_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.545937Z", "completed_at": "2024-02-29T15:28:15.555178Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.556708Z", "completed_at": "2024-02-29T15:28:15.556711Z"}], "thread_id": "Thread-2", "execution_time": 0.01247715950012207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.unique_stg_marketo__activity_email_bounced_activity_id.28833155c3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select activity_id as unique_field\n  from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_email_bounced`\n  where activity_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.550957Z", "completed_at": "2024-02-29T15:28:15.556198Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.558051Z", "completed_at": "2024-02-29T15:28:15.558055Z"}], "thread_id": "Thread-3", "execution_time": 0.008633136749267578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.not_null_stg_marketo__activity_open_email_activity_id.72e7514396", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_open_email`\nwhere activity_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.559340Z", "completed_at": "2024-02-29T15:28:15.566767Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.570068Z", "completed_at": "2024-02-29T15:28:15.570073Z"}], "thread_id": "Thread-4", "execution_time": 0.013374090194702148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.unique_stg_marketo__activity_open_email_activity_id.d48e7e93e6", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select activity_id as unique_field\n  from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_open_email`\n  where activity_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.563577Z", "completed_at": "2024-02-29T15:28:15.571140Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.572679Z", "completed_at": "2024-02-29T15:28:15.572682Z"}], "thread_id": "Thread-2", "execution_time": 0.014050960540771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.not_null_stg_marketo__activity_send_email_activity_id.4eaf534bc8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_send_email`\nwhere activity_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.567028Z", "completed_at": "2024-02-29T15:28:15.571772Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.575829Z", "completed_at": "2024-02-29T15:28:15.575832Z"}], "thread_id": "Thread-3", "execution_time": 0.013660907745361328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.unique_stg_marketo__activity_send_email_activity_id.bd25ee45d1", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select activity_id as unique_field\n  from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_send_email`\n  where activity_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.572930Z", "completed_at": "2024-02-29T15:28:15.578109Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.582842Z", "completed_at": "2024-02-29T15:28:15.582846Z"}], "thread_id": "Thread-4", "execution_time": 0.01469111442565918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.not_null_stg_marketo__activity_email_delivered_activity_id.138e450885", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_email_delivered`\nwhere activity_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.579399Z", "completed_at": "2024-02-29T15:28:15.587183Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.591252Z", "completed_at": "2024-02-29T15:28:15.591256Z"}], "thread_id": "Thread-2", "execution_time": 0.014326095581054688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.unique_stg_marketo__activity_email_delivered_activity_id.6f715c1b87", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select activity_id as unique_field\n  from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_email_delivered`\n  where activity_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.583120Z", "completed_at": "2024-02-29T15:28:15.587637Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.591559Z", "completed_at": "2024-02-29T15:28:15.591562Z"}], "thread_id": "Thread-3", "execution_time": 0.014204978942871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.not_null_stg_marketo__activity_unsubscribe_email_activity_id.a31edf42c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_unsubscribe_email`\nwhere activity_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.588138Z", "completed_at": "2024-02-29T15:28:15.593431Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.595131Z", "completed_at": "2024-02-29T15:28:15.595134Z"}], "thread_id": "Thread-4", "execution_time": 0.014453887939453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.unique_stg_marketo__activity_unsubscribe_email_activity_id.a3bca07e06", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select activity_id as unique_field\n  from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__activity_unsubscribe_email`\n  where activity_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.598252Z", "completed_at": "2024-02-29T15:28:15.606237Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.607240Z", "completed_at": "2024-02-29T15:28:15.607245Z"}], "thread_id": "Thread-3", "execution_time": 0.014107942581176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.unique_stg_marketo__lead_describe_lead_describe_id.4f0a7f9cc1", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select lead_describe_id as unique_field\n  from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__lead_describe`\n  where lead_describe_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.595383Z", "completed_at": "2024-02-29T15:28:15.606511Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.607757Z", "completed_at": "2024-02-29T15:28:15.607760Z"}], "thread_id": "Thread-2", "execution_time": 0.015232086181640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.not_null_stg_marketo__lead_describe_lead_describe_id.37612f6879", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect lead_describe_id\nfrom `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__lead_describe`\nwhere lead_describe_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.602549Z", "completed_at": "2024-02-29T15:28:15.607517Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.609521Z", "completed_at": "2024-02-29T15:28:15.609524Z"}], "thread_id": "Thread-4", "execution_time": 0.008529186248779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.not_null_stg_marketo__email_template_history_email_template_history_id.dcab273dfa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_template_history_id\nfrom `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__email_template_history`\nwhere email_template_history_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.611080Z", "completed_at": "2024-02-29T15:28:15.614233Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.614728Z", "completed_at": "2024-02-29T15:28:15.614732Z"}], "thread_id": "Thread-3", "execution_time": 0.005321979522705078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.unique_stg_marketo__email_template_history_email_template_history_id.7e3c0524e2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select email_template_history_id as unique_field\n  from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__email_template_history`\n  where email_template_history_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:14.918295Z", "completed_at": "2024-02-29T15:28:15.872859Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.874077Z", "completed_at": "2024-02-29T15:28:15.874096Z"}], "thread_id": "Thread-1", "execution_time": 0.9620952606201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.marketo_source.stg_marketo__lead", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__lead_tmp`\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    created_at\n    \n as created_timestamp , \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    id\n    \n as lead_id , \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    updated_at\n    \n as updated_timestamp , \n    cast(null as string) as \n    \n    phone\n    \n , \n    cast(null as string) as \n    \n    main_phone\n    \n , \n    cast(null as string) as \n    \n    mobile_phone\n    \n , \n    cast(null as string) as \n    \n    company\n    \n , \n    cast(null as string) as \n    \n    inferred_company\n    \n , \n    cast(null as string) as \n    \n    address_lead\n    \n , \n    cast(null as string) as \n    \n    address\n    \n , \n    cast(null as string) as \n    \n    city\n    \n , \n    cast(null as string) as \n    \n    state\n    \n , \n    cast(null as string) as \n    \n    state_code\n    \n , \n    cast(null as string) as \n    \n    country\n    \n , \n    cast(null as string) as \n    \n    country_code\n    \n , \n    cast(null as string) as \n    \n    postal_code\n    \n , \n    cast(null as string) as \n    \n    billing_street\n    \n , \n    cast(null as string) as \n    \n    billing_city\n    \n , \n    cast(null as string) as \n    \n    billing_state\n    \n , \n    cast(null as string) as \n    \n    billing_state_code\n    \n , \n    cast(null as string) as \n    \n    billing_country\n    \n , \n    cast(null as string) as \n    \n    billing_country_code\n    \n , \n    cast(null as string) as \n    \n    billing_postal_code\n    \n , \n    cast(null as string) as \n    \n    inferred_city\n    \n , \n    cast(null as string) as \n    \n    inferred_state_region\n    \n , \n    cast(null as string) as \n    \n    inferred_country\n    \n , \n    cast(null as string) as \n    \n    inferred_postal_code\n    \n , \n    cast(null as string) as \n    \n    inferred_phone_area_code\n    \n , \n    cast(null as string) as \n    \n    anonymous_ip\n    \n , \n    cast(null as boolean) as is_unsubscribed , \n    cast(null as boolean) as is_email_invalid , \n    cast(null as boolean) as \n    \n    do_not_call\n    \n \n\n\n        -- This will check if there are non-default columns to bring in\n        \n        \n        \n        \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "`dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__lead`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.887870Z", "completed_at": "2024-02-29T15:28:15.894298Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.896229Z", "completed_at": "2024-02-29T15:28:15.896245Z"}], "thread_id": "Thread-4", "execution_time": 0.019097089767456055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.unique_stg_marketo__lead_lead_id.1a4c20db9f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select lead_id as unique_field\n  from `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__lead`\n  where lead_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-29T15:28:15.880328Z", "completed_at": "2024-02-29T15:28:15.894838Z"}, {"name": "execute", "started_at": "2024-02-29T15:28:15.896779Z", "completed_at": "2024-02-29T15:28:15.896786Z"}], "thread_id": "Thread-2", "execution_time": 0.02110600471496582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.marketo_source.not_null_stg_marketo__lead_lead_id.a539cbf055", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect lead_id\nfrom `dbt-package-testing`.`marketo_source_marketo_source`.`stg_marketo__lead`\nwhere lead_id is null\n\n\n", "relation_name": null}], "elapsed_time": 3.632714033126831, "args": {"log_file_max_bytes": 10485760, "macro_debugging": false, "project_dir": "/Users/jamie.rodriguez/Desktop/dbt_repos/Marketing/Marketo/dbt_marketo_source/integration_tests", "which": "generate", "defer": false, "print": true, "select": [], "enable_legacy_logger": false, "indirect_selection": "eager", "partial_parse": true, "vars": {}, "write_json": true, "warn_error_options": {"include": [], "exclude": []}, "introspect": true, "compile": true, "favor_state": false, "partial_parse_file_diff": true, "empty_catalog": false, "send_anonymous_usage_stats": true, "show_resource_report": false, "cache_selected_only": false, "use_colors": true, "use_colors_file": true, "exclude": [], "static_parser": true, "invocation_command": "dbt docs generate", "profiles_dir": "/Users/jamie.rodriguez/.dbt", "static": false, "strict_mode": false, "log_level_file": "debug", "printer_width": 80, "quiet": false, "version_check": true, "log_path": "/Users/jamie.rodriguez/Desktop/dbt_repos/Marketing/Marketo/dbt_marketo_source/integration_tests/logs", "log_level": "info", "log_format_file": "debug", "log_format": "default", "populate_cache": true}}