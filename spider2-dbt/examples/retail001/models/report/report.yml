version: 2

models:
  - name: report_customer_invoices
    description: "Generates a report of the top 10 countries by total revenue, including total invoices and revenue for each country."
    columns:
      - name: country
        description: "The country of the customer."
        tests:
          - not_null
      - name: total_invoices
        description: "The total number of invoices generated by customers from the respective country."
        tests:
          - not_null
      - name: total_revenue
        description: "The total revenue generated by customers from the respective country."
        tests:
          - not_null
          - accepted_range:
              min_value: 0
    refs:
      - name: fct_invoices
      - name: dim_customer

  - name: report_product_invoices
    description: "Generates a report of the top 10 products by total quantity sold, including product details and quantity."
    columns:
      - name: product_id
        description: "The unique identifier for the product."
        tests:
          - not_null
          - unique
      - name: stock_code
        description: "The stock code associated with the product."
        tests:
          - not_null
      - name: description
        description: "The description of the product."
        tests:
          - not_null
      - name: total_quantity_sold
        description: "The total quantity sold for the product."
        tests:
          - not_null
          - accepted_range:
              min_value: 0
    refs:
      - name: fct_invoices
      - name: dim_product

  - name: report_year_invoices
    description: "Generates a monthly report of invoices for each year, including the number of invoices and total revenue."
    columns:
      - name: year
        description: "The year of the invoice."
        tests:
          - not_null
      - name: month
        description: "The month of the invoice."
        tests:
          - not_null
      - name: num_invoices
        description: "The total number of distinct invoices for that month and year."
        tests:
          - not_null
          - accepted_range:
              min_value: 0
      - name: total_revenue
        description: "The total revenue generated for the respective month and year."
        tests:
          - not_null
          - accepted_range:
              min_value: 0
    refs:
      - name: fct_invoices
      - name: dim_datetime
