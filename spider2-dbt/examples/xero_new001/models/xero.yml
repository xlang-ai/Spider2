version: 2

models:
  - name: xero__profit_and_loss_report
    description: 
      This model represents individual line items in the profit and loss (P&L) report at the month and account level. It is derived from `xero__general_ledger` and aggregates net amounts for revenue and expenses. Each record reflects the monthly movement of funds for a given account, which helps assess an organization's financial performance over time.
    columns:
      - name: profit_and_loss_id
        description: 
          A unique identifier for each record in the profit and loss report. This ID is generated by combining the month, account ID, and source relation, ensuring that each record is uniquely identifiable.
        tests:
          - unique  
          - not_null
      - name: date_month
        description: 
          The month when the revenue or expense was recorded. This field is used to aggregate data on a monthly basis for reporting purposes.
      - name: account_id
        description: 
          The unique identifier for the account in Xero. This ID allows the report to be linked to other data sources or reports that also reference this account.
      - name: account_name
        description: 
          The name of the account in Xero. This provides a human-readable reference for the account being reported on, such as "Sales" or "Office Supplies".
      - name: account_code
        description: 
          The code assigned to the account in Xero. This alphanumeric code is used for internal categorization and reporting purposes.
      - name: account_type
        description: 
          The type of the related account in Xero, which provides further classification of the account (e.g., "Revenue", "Expense").
      - name: account_class
        description: 
          The high-level classification of the account, which is used to distinguish between different parts of the financial statement, such as "REVENUE" or "EXPENSE".
      - name: net_amount
        description: 
          The net movement of funds for this account in the specified month. This value reflects either an income or expense movement, where positive values typically represent income (revenue), and negative values represent expenses.
      - name: source_relation
        description: >
          The source from which this data was pulled. If using the `union_schemas` variable, this will contain the source schema. If using the `union_databases` variable, this will indicate the source database. If no multiple sources are combined, this will be an empty string.


  - name: xero__invoice_line_items
    description: Each record represents an invoice line item, enriched with account, contact and invoice information.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - line_item_id
            - source_relation
    columns:
      - name: _fivetran_synced
        description: "{{ doc('_fivetran_synced') }}"
      - name: account_code
        description: Customer defined alpha numeric account code e.g 200 or SALES
      - name: line_item_description
        description: The description of the line item
      - name: discount_entered_as_percent
        description: The discount rate for the line item as a percentage.
      - name: discount_rate
        description: Percentage discount being applied to a line item.
      - name: invoice_id
        description: The Xero identifier for the invoice the line items belongs to.
      - name: item_code
        description: User defined item code.
      - name: line_amount
        description: The line amount reflects the discounted price if a DiscountRate has been used.
      - name: line_item_id
        description: Xero identifier for the line item.
        tests:
          - not_null
      - name: quantity
        description: The quantity of the line item.
      - name: tax_amount
        description: The tax amount is auto calculated as a percentage of the line amount based on the tax rate.
      - name: tax_type
        description: Used as an override if the default Tax Code for the selected AccountCode is not correct.
      - name: unit_amount
        description: The unit amount of each line item. 
      - name: invoice_date
        description: The date the invoice was issued.
      - name: updated_date
        description: The date the invoice was last modified.
      - name: planned_payment_date
        description: The planned payment date of the invoice, when set.
      - name: due_date
        description: The date the invoice is/was due.
      - name: expected_payment_date
        description: The expected payment date of the invoice, when set.
      - name: fully_paid_on_date
        description: The date the invoice was fully paid. Only returned on fully paid invoices
      - name: currency_code
        description: The currency that invoice has been raised in
      - name: currency_rate
        description: The currency rate for a multicurrency invoice
      - name: invoice_number
        description: Alpha numeric code identifying invoice
      - name: invoice_reference
        description: Additional reference number. For accounts receivable only.
      - name: is_sent_to_contact
        description: Boolean to indicate whether the invoice in the Xero app displays as "sent"
      - name: invoice_status
        description: The status of the invoice
      - name: type
        description: The type of the invoice.
      - name: url
        description: URL link to a source document
      - name: account_id
        description: The Xero identifier for the related account.
      - name: account_name
        description: The name of the account.
      - name: account_code
        description: Customer defined alpha numeric account code e.g 200 or SALES
      - name: account_type
        description: The type of account, e.g. CURRENT, EQUITY, SALES
      - name: account_class
        description: The class of account, e.g. ASSET, EQUITY, EXPENSE, LIABILITY, REVENUE
      - name: contact_name
        description: The name of the associated contact.
      - name: source_relation
        description: >
          The source where this data was pulled from. If you are making use of the `union_schemas` variable, this will be the source schema.
          If you are making use of the `union_databases` variable, this will be the source database. If you are not unioining together multiple
          sources, this will be an empty string.

  - name: xero__general_ledger
    description: 
      This table represents each individual journal line item recorded in the Xero accounting system. It is essential for constructing both the balance sheet and profit and loss statement. Each line item corresponds to an accounting transaction that impacts one or more accounts, and contains detailed information on the transaction, including the related account, amounts, and tax details.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - journal_line_id
            - source_relation
            - journal_id
    columns:
      - name: journal_line_id
        description: 
          The unique identifier for each journal line item in Xero. Each journal entry consists of one or more journal lines, and this ID allows tracking of the individual transaction lines within a journal entry.
      - name: journal_id
        description: 
          The unique identifier for the journal entry. This links multiple journal lines together under a single accounting event. For example, a sales invoice might generate multiple journal lines representing different parts of the transaction (revenue, tax, etc.).
        tests:
          - not_null
      - name: created_date_utc
        description: 
          The UTC date and time when the journal entry was created in Xero. This can be used to track when the transaction was initially recorded.
      - name: journal_date
        description: 
          The date on which the journal entry was posted. This is the effective date of the accounting transaction and may differ from the creation date.
      - name: journal_number
        description: 
          The unique journal number assigned by Xero. This number can be used for internal reference or auditing purposes.
      - name: reference
        description: 
          Any associated reference for the journal entry, such as a purchase order number or invoice number, which may be used to trace the origin of the transaction.
      - name: source_id
        description: 
          The unique identifier for the source transaction that generated this journal line. This field is used to link the journal entry to its origin, such as an invoice or a payment, allowing for more detailed investigation or reconciliation.
      - name: source_type
        description: 
          The type of source transaction that generated the journal entry. This determines which table the journal can be linked to for additional details. Common values include invoices, bank transactions, payments, etc.
      - name: account_code
        description: 
          The alphanumeric code representing the account impacted by this journal line. This code is defined by the customer and is often used in reporting or categorization, such as "200" or "SALES".
      - name: account_id
        description: 
          The Xero identifier for the account associated with this journal line. This is the internal ID used to join to other tables that contain account details.
      - name: account_name
        description: 
          The human-readable name of the account related to this journal line. This can provide additional clarity in reports or analysis, such as "Revenue" or "Accounts Receivable".
      - name: account_type
        description: 
          The classification of the account associated with this journal line, such as "Asset", "Liability", "Revenue", or "Expense". This field is critical for constructing financial statements.
      - name: description
        description: 
          A description or narrative explaining the journal line. This is often derived from the source transaction and may provide additional context for the entry.
      - name: gross_amount
        description: 
          The total gross amount for the journal line, calculated as the sum of the net amount and the tax amount. This represents the full value of the transaction, including taxes.
      - name: net_amount
        description: 
          The net amount for the journal line, excluding taxes. In accounting, this is typically the actual transaction value, which is positive for debits and negative for credits.
      - name: tax_amount
        description: 
          The total tax applied to the journal line. This can be used to calculate the tax liability or recoverable tax for the transaction.
      - name: tax_name
        description: 
          The name of the tax rate applied to the journal line, such as "GST" or "VAT". This can be used to differentiate between different tax rates in reports.
      - name: tax_type
        description: 
          The type or category of tax applied to this journal line. This might be specific to the local tax jurisdiction or the type of transaction.
      - name: account_class
        description: 
          A broader classification of the account, such as "Asset", "Equity", "Expense", "Liability", or "Revenue". This field is used to group accounts into higher-level categories in financial reporting.
      - name: invoice_id
        description: 
          The unique identifier for the invoice, where applicable. This allows joining the journal line to the invoice table to access details about the related invoice transaction.
      - name: bank_transaction_id
        description: 
          The unique identifier for the bank transaction, where applicable. This can be used to join the journal line to the bank transaction table for further details about the cash movement.
      - name: bank_transfer_id
        description: 
          The unique identifier for a bank transfer, if this journal line was generated from a transfer of funds between bank accounts.
      - name: manual_journal_id
        description: 
          The unique identifier for manual journal entries, used for adjusting entries made directly in the general ledger without an associated source transaction.
      - name: payment_id
        description: 
          The unique identifier for a payment transaction, if this journal line was generated from a payment event. This can be linked to the payment table for more details.
      - name: credit_note_id
        description: 
          The unique identifier for a credit note, where applicable. This field allows the journal line to be joined to the credit note table to trace any credit adjustments.
      - name: contact_id
        description: 
          The unique identifier for the associated contact, such as a customer or vendor, related to the journal entry. This field is populated when the journal line is linked to a contact.
      - name: contact_name
        description: 
          The name of the contact, such as the customer or vendor, associated with the journal entry. This field provides context for identifying the external party involved in the transaction.
      - name: source_relation
        description: >
          The source where this data was pulled from. If using the `union_schemas` variable, this field will contain the source schema. If using the `union_databases` variable, it will contain the source database. If there are no multiple sources combined, this will be an empty string.


  - name: xero__balance_sheet_report
    description: 
      This model represents the state of the balance sheet for each account at the end of each month. The data is sourced from `xero__general_ledger`, and net balances are calculated for accounts classified as assets, liabilities, and equity. The report provides a monthly snapshot of the organization's financial position.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - source_relation
            - date_month
            - account_name
    columns:
      - name: date_month
        description: 
          The month being reported. This field captures the financial status of the balance sheet as of the last day of the given month.
      - name: account_name
        description: 
          The name of the related account in Xero. This can either be a standard account (e.g., Cash, Accounts Receivable) or a summarized earnings account (Retained Earnings or Current Year Earnings) based on the logic in the model.
      - name: account_code
        description: 
          The alphanumeric code assigned to the account in Xero, which can be used for categorizing and reporting.
      - name: account_class
        description: 
          The classification of the account in Xero, such as "Asset", "Liability", or "Equity". This helps group accounts into major sections of the balance sheet.
      - name: account_id
        description: 
          The unique identifier for the account in Xero. This ID can be used to join to other tables or systems for further details about the account.
      - name: account_type
        description: 
          The type of account in Xero. This field provides more granular categorization within the broader "account_class" field (e.g., within "Asset", there may be types like "Current Asset" or "Fixed Asset").
      - name: net_amount
        description: 
          The net balance amount for the account at the end of the reported month. For balance sheet accounts (assets, liabilities, and equity), this represents the actual financial balance. For earnings accounts, it summarizes the earnings for the period.
      - name: source_relation
        description: >
          The source from which this data was retrieved. If you are using the `union_schemas` variable, this will reflect the schema of the source. If using the `union_databases` variable, this will indicate the source database. If no multiple sources are being combined, this will be an empty string.

