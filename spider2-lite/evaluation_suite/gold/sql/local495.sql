SELECT ci.campaign_name, COUNT(e.event_type) AS add_to_cart_events FROM shopping_cart_events e JOIN shopping_cart_page_hierarchy ph ON e.page_id = ph.page_id JOIN shopping_cart_campaign_identifier ci ON ci.products LIKE '%' || ph.product_id || '%' WHERE e.event_type = (SELECT event_type FROM shopping_cart_event_identifier WHERE event_name = 'Add to Cart') GROUP BY ci.campaign_name;