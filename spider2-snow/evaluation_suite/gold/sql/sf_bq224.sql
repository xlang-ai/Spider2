WITH approved_repos AS ( SELECT DISTINCT T1."repo_name" FROM GITHUB_REPOS_DATE.GITHUB_REPOS.LICENSES T1 JOIN GITHUB_REPOS_DATE.GITHUB_REPOS.LICENSES T2 ON LOWER(T1."license") = LOWER(T2."license") ), events_agg AS ( SELECT TRY_PARSE_JSON(E."repo"):"name"::STRING AS repo_name, SUM(CASE WHEN E."type" = 'ForkEvent'  THEN 1 ELSE 0 END) AS fork_events, SUM(CASE WHEN E."type" = 'IssuesEvent' THEN 1 ELSE 0 END) AS issues_events, SUM(CASE WHEN E."type" = 'WatchEvent' THEN 1 ELSE 0 END) AS watch_events FROM GITHUB_REPOS_DATE.MONTH._202204 E WHERE TO_TIMESTAMP(E."created_at" / 1000000) >= '2022-04-01' AND TO_TIMESTAMP(E."created_at" / 1000000) < '2022-05-01' AND E."type" IN ('ForkEvent','IssuesEvent','WatchEvent') GROUP BY TRY_PARSE_JSON(E."repo"):"name"::STRING ), totals AS ( SELECT repo_name, fork_events + issues_events + watch_events AS total_events FROM events_agg ) SELECT T.repo_name FROM totals T JOIN approved_repos A ON T.repo_name = A."repo_name" ORDER BY T.total_events DESC LIMIT 1;