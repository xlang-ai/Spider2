WITH MinMaxAge AS (
  SELECT
    MIN("age") AS min_age,
    MAX("age") AS max_age
  FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."USERS"
  WHERE
    CAST(TO_TIMESTAMP_NTZ("created_at" / 1000000) AS DATE) BETWEEN '2019-01-01' AND '2022-04-30'
)
SELECT
  SUM(CASE WHEN T."age" = M.max_age THEN 1 ELSE 0 END) - SUM(CASE WHEN T."age" = M.min_age THEN 1 ELSE 0 END)
FROM "THELOOK_ECOMMERCE"."THELOOK_ECOMMERCE"."USERS" AS T
CROSS JOIN MinMaxAge AS M
WHERE
  CAST(TO_TIMESTAMP_NTZ(T."created_at" / 1000000) AS DATE) BETWEEN '2019-01-01' AND '2022-04-30'