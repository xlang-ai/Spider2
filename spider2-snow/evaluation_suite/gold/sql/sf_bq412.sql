WITH parsed_regions AS (SELECT "creative_page_url", value:"first_shown"::STRING AS first_shown_str, value:"last_shown"::STRING AS last_shown_str, value:"times_shown_lower_bound"::NUMBER AS times_shown_lower, value:"times_shown_upper_bound"::NUMBER AS times_shown_upper, value:"region_code"::STRING AS region_code, value:"times_shown_availability_date" AS availability_date FROM GOOGLE_ADS.GOOGLE_ADS_TRANSPARENCY_CENTER.REMOVED_CREATIVE_STATS, LATERAL FLATTEN(INPUT => PARSE_JSON("region_stats"))), filtered_regions AS (SELECT "creative_page_url", TO_TIMESTAMP(first_shown_str) AS "first_shown", TO_TIMESTAMP(last_shown_str) AS "last_shown", times_shown_lower, times_shown_upper FROM parsed_regions WHERE region_code = 'HR' AND availability_date IS NULL AND times_shown_lower > 10000 AND times_shown_upper < 25000) SELECT T1."creative_page_url", T2."first_shown", T2."last_shown", PARSE_JSON(T1."disapproval")[0]:"removal_reason"::STRING AS "removal_reason", PARSE_JSON(T1."disapproval")[0]:"violation_category"::STRING AS "violation_category", T2.times_shown_lower, T2.times_shown_upper FROM GOOGLE_ADS.GOOGLE_ADS_TRANSPARENCY_CENTER.REMOVED_CREATIVE_STATS T1 INNER JOIN filtered_regions T2 ON T1."creative_page_url" = T2."creative_page_url" WHERE (PARSE_JSON(T1."audience_selection_approach_info"):"demographic_info"::STRING != 'CRITERIA_UNUSED' OR PARSE_JSON(T1."audience_selection_approach_info"):"geo_location"::STRING != 'CRITERIA_UNUSED' OR PARSE_JSON(T1."audience_selection_approach_info"):"contextual_signals"::STRING != 'CRITERIA_UNUSED' OR PARSE_JSON(T1."audience_selection_approach_info"):"customer_lists"::STRING != 'CRITERIA_UNUSED' OR PARSE_JSON(T1."audience_selection_approach_info"):"topics_of_interest"::STRING != 'CRITERIA_UNUSED') ORDER BY T2."last_shown" DESC LIMIT 5;